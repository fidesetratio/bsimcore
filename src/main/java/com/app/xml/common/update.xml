<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
  'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>
<mapper namespace='com.app.dao.CommonDao'>
	
	 <update id="updateMstDetVaByNoVa" parameterType="java.util.HashMap">
         update eka.mst_det_va 
         <trim prefix="SET" suffixOverrides=",">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            <if test="flag_active !=null"> flag_active = #{flag_active},</if>
            <if test="input_date !=null"> input_date = #{input_date},</if>   
            <if test="user_input !=null"> user_input = #{user_input},</if>  
            <if test="no_spaj_gadget !=null"> no_spaj_gadget = #{no_spaj_gadget}</if>                                                                                                                                                                                                                                                                                                                                                                                                        
        </trim> 
        where no_va = #{no_va}
    </update>
    
  
    <update id="commonupdateMstCounter" parameterType="java.util.HashMap">
       UPDATE EKA.MST_COUNTER 
        SET EKA.MST_COUNTER.MSCO_VALUE = #{intIDCounter:NUMERIC} 
        WHERE EKA.MST_COUNTER.MSCO_NUMBER = 1 AND 
              EKA.MST_COUNTER.LCA_ID = #{strBranch:VARCHAR}
    </update>    
    
    <insert id="insertMstAgentTmp" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_AGENT_TEMP
            (REG_SPAJ,MAT_NAMA_AGENT)
        VALUES
            (#{strTmpSPAJ:VARCHAR},#{v_stragentnama:VARCHAR})
    </insert>
    
     <update id="updateMstCounterClient" parameterType="java.util.HashMap">
       UPDATE EKA.MST_COUNTER 
        SET EKA.MST_COUNTER.MSCO_VALUE = #{intIDCounter:NUMERIC} 
        WHERE EKA.MST_COUNTER.MSCO_NUMBER = 3 AND 
              EKA.MST_COUNTER.LCA_ID = #{strBranch:VARCHAR}
    </update>    
    
    <update id="updateClientTtg" parameterType="com.app.model.gadget.prod.Tertanggung">
           UPDATE EKA.MST_CLIENT_NEW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            LGJ_ID = upper(#{lgj_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LJB_ID = upper(#{ljb_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LSAG_ID = (#{lsag_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            LSED_ID = (#{lsed_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            LSIDE_ID = (#{lside_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            LSNE_ID = (#{lsne_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            MCL_FIRST = upper(#{mcl_first:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            MCL_GELAR = upper(#{mcl_gelar:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            MCL_JENIS = (#{mcl_jenis:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            MKL_INDUSTRI = upper(#{mkl_industri:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MKL_KERJA = upper(#{mkl_kerja:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            MKL_PENDANAAN = upper(#{mkl_pendanaan:VARCHAR}),
            MKL_SMBR_PENGHASILAN = upper (#{mkl_smbr_penghasilan:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            MKL_PENGHASILAN = upper(#{mkl_penghasilan:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            MKL_TUJUAN = upper(#{mkl_tujuan:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            MPN_JOB_DESC = upper(#{mpn_job_desc:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MSPE_DATE_BIRTH = (#{mspe_date_birth:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            MSPE_MOTHER = upper(#{mspe_mother:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
            MSPE_NO_IDENTITY = upper(trim(replace(replace(replace(replace(replace(replace( #{mspe_no_identity:VARCHAR} ,'/'),'.'),','),'\'),'-'),' '))),  
            MSPE_NO_IDENTITY_EXPIRED = (#{mspe_no_identity_expired:DATE}),
            MSPE_PLACE_BIRTH = upper(#{mspe_place_birth:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            MSPE_SEX = (#{mspe_sex:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            MSPE_STS_MRT = upper(#{mspe_sts_mrt:VARCHAR}),
            MSPE_EMAIL = upper(#{email:VARCHAR}),                   
            lti_id = #{lti_id:INTEGER},
            MCL_AGAMA= upper(#{mcl_agama:VARCHAR}),
            MKL_DANA_FROM = #{mkl_dana_from:INTEGER},
            MKL_HASIL_FROM = #{mkl_hasil_from:INTEGER},
            MKL_SMBR_HASIL_FROM = #{mkl_smbr_hasil_from:INTEGER},
            MKL_SUMBER_PREMI = #{mkl_sumber_premi:INTEGER},
            LSRE_ID_PREMI = (#{lsre_id_premi:INTEGER}),
            MKL_RED_FLAG = (#{mkl_red_flag:INTEGER}),
            MCL_FIRST_ALIAS = (#{mcl_first_alias:VARCHAR}),
            MCL_GREEN_CARD = (#{mcl_green_card:VARCHAR}),
            MCL_COMPANY_NAME = (#{mcl_company_name:VARCHAR}),
            mkl_kerja_ket = (#{mkl_kerja_ket:VARCHAR}),
            MCL_NPWP = (#{mcl_npwp:VARCHAR})
        WHERE MCL_ID = upper(#{mcl_id:VARCHAR})  
    </update>
    
     <update id="updateMstAddressTtg" parameterType="com.app.model.gadget.prod.Tertanggung">
     UPDATE EKA.MST_ADDRESS_NEW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ALAMAT_KANTOR = upper(#{alamat_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ALAMAT_RUMAH = upper(#{alamat_rumah:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            AREA_CODE_FAX = upper(#{area_code_fax:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            AREA_CODE_KANTOR = upper(#{area_code_kantor:VARCHAR})  ,                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            AREA_CODE_KANTOR2 = upper(#{area_code_kantor2:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            AREA_CODE_RUMAH = upper(#{area_code_rumah:VARCHAR})  ,                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            AREA_CODE_RUMAH2 = upper(#{area_code_rumah2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            EMAIL = upper(#{email:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            KD_POS_KANTOR = upper(#{kd_pos_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            KD_POS_RUMAH = upper(#{kd_pos_rumah:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            KOTA_KANTOR = upper(#{kota_kantor:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            KOTA_RUMAH = upper(#{kota_rumah:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            NO_FAX = upper(#{no_fax:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            NO_HP = upper(#{no_hp:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            NO_HP2 = upper(#{no_hp2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            TELPON_KANTOR = upper(#{telpon_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            TELPON_KANTOR2 = upper(#{telpon_kantor2:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            TELPON_RUMAH = upper(#{telpon_rumah:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            TELPON_RUMAH2 = upper(#{telpon_rumah2:VARCHAR}) ,
            ALAMAT_TPT_TINGGAL = upper(#{alamat_tpt_tinggal:VARCHAR}),
            KOTA_TPT_TINGGAL = upper(#{kota_tpt_tinggal:VARCHAR}),
            KD_POS_TPT_TINGGAL = (#{kd_pos_tpt_tinggal:VARCHAR})
        WHERE MCL_ID = upper(#{mcl_id:VARCHAR})      
     </update>
    
    
    <insert id="insertMstClientTtg" parameterType="com.app.model.gadget.prod.Tertanggung">
        INSERT INTO EKA.MST_CLIENT_NEW (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
        MCL_ID , MCL_JENIS, MCL_FIRST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
        , MCL_BLACKLIST, MCL_TGL_INPUT, LUS_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        , MCL_DATA_SALAH , MCL_GELAR, LSIDE_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        , MSPE_NO_IDENTITY 
        , MSPE_NO_IDENTITY_EXPIRED
        , LSED_ID, LGJ_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        , LJB_ID, MPN_JOB_DESC, MSPE_MOTHER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        , MSPE_SEX, MSPE_DATE_BIRTH, MSPE_PLACE_BIRTH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
        , LSAG_ID , MSPE_STS_MRT , LSNE_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
        , MSPE_LAMA_KERJA, MSPE_EMAIL, MKL_TUJUAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
        , MKL_PENGHASILAN , MKL_PENDANAAN , MKL_SMBR_PENGHASILAN, MKL_KERJA,  MKL_INDUSTRI     , lti_id, mcl_agama
        , MKL_DANA_FROM, MKL_HASIL_FROM, MKL_SMBR_HASIL_FROM, MKL_SUMBER_PREMI, LSRE_ID_PREMI, MKL_RED_FLAG
        , MCL_FIRST_ALIAS,MCL_GREEN_CARD,MCL_COMPANY_NAME,MKL_KERJA_KET,MCL_NPWP
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
         upper(#{mcl_id:VARCHAR}),  0,  upper(#{mcl_first:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        ,  0,  SYSDATE,  (#{lus_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        ,  NULL,  upper(#{mcl_gelar:VARCHAR}),  (#{lside_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        ,  upper(trim(replace(replace(replace(replace(replace(replace(#{mspe_no_identity:VARCHAR},'/'),'.'),','),'\'),'-'),' ')))
        ,  (#{mspe_no_identity_expired:DATE})
        ,  (#{lsed_id:INTEGER}),  upper(#{lgj_id:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
        ,  upper(#{ljb_id:VARCHAR}),  upper(#{mpn_job_desc:VARCHAR}),  upper(#{mspe_mother:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
        ,  (#{mspe_sex:INTEGER}),  (#{mspe_date_birth:DATE}),  upper(#{mspe_place_birth:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
        ,  (#{lsag_id:INTEGER}),  upper(#{mspe_sts_mrt:VARCHAR}),  (#{lsne_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
        ,  NULL,  upper(#{email:VARCHAR}),  upper(#{mkl_tujuan:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        ,  upper(#{mkl_penghasilan:VARCHAR}), upper(#{mkl_pendanaan:VARCHAR}) , upper(#{mkl_smbr_penghasilan:VARCHAR}), upper(#{mkl_kerja:VARCHAR}), upper(#{mkl_industri:VARCHAR}), #{lti_id:INTEGER}, upper(#{mcl_agama:VARCHAR})
        ,  (#{mkl_dana_from:INTEGER}), (#{mkl_hasil_from:INTEGER}), (#{mkl_smbr_hasil_from:INTEGER}), (#{mkl_sumber_premi:INTEGER}), (#{lsre_id_premi:INTEGER}), (#{mkl_red_flag:INTEGER})
        , upper(#{mcl_first_alias:VARCHAR}),(#{mcl_green_card:VARCHAR}),upper(#{mcl_company_name:VARCHAR}),upper(#{mkl_kerja_ket:VARCHAR}),(#{mcl_npwp:VARCHAR})
        )           
    </insert>
    
    <insert id="insertMstAddressTtg" parameterType="com.app.model.gadget.prod.Tertanggung">
        INSERT INTO EKA.MST_ADDRESS_NEW (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            TELPON_RUMAH2 , AREA_CODE_KANTOR2, TELPON_KANTOR2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            , AREA_CODE_FAX, MCL_ID, ALAMAT_RUMAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            , KD_POS_RUMAH, KOTA_RUMAH, AREA_CODE_RUMAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            , TELPON_RUMAH, ALAMAT_KANTOR, KD_POS_KANTOR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , KOTA_KANTOR, AREA_CODE_KANTOR, TELPON_KANTOR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , EMAIL, NO_HP, NO_HP2
            , NO_FAX, AREA_CODE_RUMAH2  ,ALAMAT_TPT_TINGGAL,KOTA_TPT_TINGGAL,KD_POS_TPT_TINGGAL
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
             upper(#{telpon_rumah2:VARCHAR}),  upper(#{area_code_kantor2:VARCHAR}),  upper(#{telpon_kantor2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            ,  upper(#{area_code_fax:VARCHAR}),  upper(#{mcl_id:VARCHAR}),  upper(#{alamat_rumah:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            ,  upper(#{kd_pos_rumah:VARCHAR}),  upper(#{kota_rumah:VARCHAR}),  upper(#{area_code_rumah:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ,  upper(#{telpon_rumah:VARCHAR}),  upper(#{alamat_kantor:VARCHAR}),  upper(#{kd_pos_kantor:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  upper(#{kota_kantor:VARCHAR}),  upper(#{area_code_kantor:VARCHAR}),  upper(#{telpon_kantor:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  upper(#{email:VARCHAR}),  upper(#{no_hp:VARCHAR}),  upper(#{no_hp2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            ,  upper(#{no_fax:VARCHAR}),  upper(#{area_code_rumah2:VARCHAR}),upper(#{alamat_tpt_tinggal:VARCHAR}) ,upper(#{kota_tpt_tinggal:VARCHAR}),(#{kd_pos_tpt_tinggal:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        )                       
    </insert>   
    
    <update id="updateMstClientPP" parameterType="com.app.model.gadget.prod.Pemegang">
    UPDATE EKA.MST_CLIENT_NEW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
        SET                                                                                                                                                                                                                                                                                                                                                                    
            LGJ_ID = upper(#{lgj_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LJB_ID = upper(#{ljb_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LSAG_ID = (#{lsag_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            LSED_ID = (#{lsed_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            LSIDE_ID = (#{lside_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            LSNE_ID = (#{lsne_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            MCL_FIRST = upper(#{mcl_first:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            MCL_GREEN_CARD = (#{mcl_green_card:VARCHAR}),
            MCL_COMPANY_NAME = (#{mcl_company_name:VARCHAR}),
            mkl_kerja_ket = (#{mkl_kerja_ket:VARCHAR}),
            MCL_NPWP = (#{mcl_npwp:VARCHAR}),
            lti_id = #{lti_id:INTEGER},                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            MCL_GELAR = upper(#{mcl_gelar:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
            MCL_JENIS = (#{mcl_jenis:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
            MKL_INDUSTRI = upper(#{mkl_industri:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            MKL_KERJA = upper(#{mkl_kerja:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            MKL_PENDANAAN = upper(#{mkl_pendanaan:VARCHAR}),
            MKL_SMBR_PENGHASILAN = upper (#{mkl_smbr_penghasilan:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            MKL_PENGHASILAN = upper(#{mkl_penghasilan:VARCHAR}), 
            MKL_TUJUAN = upper(#{mkl_tujuan:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            MPN_JOB_DESC = upper(#{mpn_job_desc:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MSPE_DATE_BIRTH = (#{mspe_date_birth:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MSPE_MOTHER = upper(#{mspe_mother:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            MSPE_NO_IDENTITY = upper(trim(replace(replace(replace(replace(replace(replace( #{mspe_no_identity:VARCHAR} ,'/'),'.'),','),'\'),'-'),' '))),  
            MSPE_NO_IDENTITY_EXPIRED = (#{mspe_no_identity_expired:DATE}),
            MSPE_PLACE_BIRTH = upper(#{mspe_place_birth:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            MSPE_SEX = (#{mspe_sex:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            MSPE_STS_MRT = upper(#{mspe_sts_mrt:VARCHAR}),
            MSPE_EMAIL = upper(#{email:VARCHAR}), 
            MCL_AGAMA= upper(#{mcl_agama:VARCHAR}),
            MKL_DANA_FROM = #{mkl_dana_from:INTEGER},
            MKL_HASIL_FROM = #{mkl_hasil_from:INTEGER},
            MKL_SMBR_HASIL_FROM = #{mkl_smbr_hasil_from:INTEGER},
            MKL_SUMBER_PREMI = #{mkl_sumber_premi:INTEGER},
            LSRE_ID_PREMI = (#{lsre_id_premi:INTEGER}),
            MKL_RED_FLAG = (#{mkl_red_flag:INTEGER})
        WHERE MCL_ID = upper(#{mcl_id:VARCHAR})   
    </update>  
    
    <insert id="insertMstClientPP" parameterType="com.app.model.gadget.prod.Pemegang">
        INSERT INTO EKA.MST_CLIENT_NEW (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
        MCL_ID , MCL_JENIS, MCL_FIRST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
        , MCL_BLACKLIST, MCL_TGL_INPUT, LUS_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        , MCL_DATA_SALAH , MCL_GELAR, LSIDE_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        , MSPE_NO_IDENTITY 
        , MSPE_NO_IDENTITY_EXPIRED
        , LSED_ID, LGJ_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        , LJB_ID, MPN_JOB_DESC, MSPE_MOTHER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        , MSPE_SEX, MSPE_DATE_BIRTH, MSPE_PLACE_BIRTH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
        , LSAG_ID , MSPE_STS_MRT , LSNE_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
        , MSPE_LAMA_KERJA, MSPE_EMAIL, MKL_TUJUAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
        , MKL_PENGHASILAN , MKL_PENDANAAN , MKL_SMBR_PENGHASILAN, MKL_KERJA,  MKL_INDUSTRI     , lti_id, mcl_agama
        , MKL_DANA_FROM, MKL_HASIL_FROM, MKL_SMBR_HASIL_FROM, MKL_SUMBER_PREMI, LSRE_ID_PREMI, MKL_RED_FLAG
        , MCL_FIRST_ALIAS,MCL_GREEN_CARD,MCL_COMPANY_NAME,MKL_KERJA_KET,MCL_NPWP
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
         upper(#{mcl_id:VARCHAR}),  0,  upper(#{mcl_first:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
        ,  0,  SYSDATE,  (#{lus_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        ,  NULL,  upper(#{mcl_gelar:VARCHAR}),  (#{lside_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        ,  upper(trim(replace(replace(replace(replace(replace(replace(#{mspe_no_identity:VARCHAR},'/'),'.'),','),'\'),'-'),' ')))
        ,  (#{mspe_no_identity_expired:DATE})
        ,  (#{lsed_id:INTEGER}),  upper(#{lgj_id:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
        ,  upper(#{ljb_id:VARCHAR}),  upper(#{mpn_job_desc:VARCHAR}),  upper(#{mspe_mother:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
        ,  (#{mspe_sex:INTEGER}),  (#{mspe_date_birth:DATE}),  upper(#{mspe_place_birth:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
        ,  (#{lsag_id:INTEGER}),  upper(#{mspe_sts_mrt:VARCHAR}),  (#{lsne_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
        ,  NULL,  upper(#{email:VARCHAR}),  upper(#{mkl_tujuan:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        ,  upper(#{mkl_penghasilan:VARCHAR}), upper(#{mkl_pendanaan:VARCHAR}) , upper(#{mkl_smbr_penghasilan:VARCHAR}), upper(#{mkl_kerja:VARCHAR}), upper(#{mkl_industri:VARCHAR}), #{lti_id:INTEGER}, upper(#{mcl_agama:VARCHAR})
        ,  (#{mkl_dana_from:INTEGER}), (#{mkl_hasil_from:INTEGER}), (#{mkl_smbr_hasil_from:INTEGER}), (#{mkl_sumber_premi:INTEGER}), (#{lsre_id_premi:INTEGER}), (#{mkl_red_flag:INTEGER})
        , upper(#{mcl_first_alias:VARCHAR}),(#{mcl_green_card:VARCHAR}),upper(#{mcl_company_name:VARCHAR}),upper(#{mkl_kerja_ket:VARCHAR}),(#{mcl_npwp:VARCHAR})
        )           
    </insert>
    
    <update id="updateMstAddressPP" parameterType="com.app.model.gadget.prod.Pemegang">
        UPDATE EKA.MST_ADDRESS_NEW                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ALAMAT_KANTOR = upper(#{alamat_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ALAMAT_RUMAH = upper(#{alamat_rumah:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            AREA_CODE_FAX = upper(#{area_code_fax:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            AREA_CODE_KANTOR = upper(#{area_code_kantor:VARCHAR})  ,                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            AREA_CODE_KANTOR2 = upper(#{area_code_kantor2:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            AREA_CODE_RUMAH = upper(#{area_code_rumah:VARCHAR})  ,                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            AREA_CODE_RUMAH2 = upper(#{area_code_rumah2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            EMAIL = upper(#{email:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            KD_POS_KANTOR = upper(#{kd_pos_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            KD_POS_RUMAH = upper(#{kd_pos_rumah:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            KOTA_KANTOR = upper(#{kota_kantor:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            KOTA_RUMAH = upper(#{kota_rumah:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            NO_FAX = upper(#{no_fax:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            NO_HP = upper(#{no_hp:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            NO_HP2 = upper(#{no_hp2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            TELPON_KANTOR = upper(#{telpon_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            TELPON_KANTOR2 = upper(#{telpon_kantor2:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            TELPON_RUMAH = upper(#{telpon_rumah:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            TELPON_RUMAH2 = upper(#{telpon_rumah2:VARCHAR}) ,
            ALAMAT_TPT_TINGGAL = upper(#{alamat_tpt_tinggal:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
        KOTA_TPT_TINGGAL = upper(#{kota_tpt_tinggal:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        KD_POS_TPT_TINGGAL = upper(#{kd_pos_tpt_tinggal:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        WHERE MCL_ID = upper(#{mcl_id:VARCHAR})
    </update>
    
    <insert id="insertMstAddressPP" parameterType="com.app.model.gadget.prod.Pemegang">
        INSERT INTO EKA.MST_ADDRESS_NEW (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            TELPON_RUMAH2 , AREA_CODE_KANTOR2, TELPON_KANTOR2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            , AREA_CODE_FAX, MCL_ID, ALAMAT_RUMAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            , KD_POS_RUMAH, KOTA_RUMAH, AREA_CODE_RUMAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            , TELPON_RUMAH, ALAMAT_KANTOR, KD_POS_KANTOR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , KOTA_KANTOR, AREA_CODE_KANTOR, TELPON_KANTOR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , EMAIL, NO_HP, NO_HP2
            , NO_FAX, AREA_CODE_RUMAH2 ,ALAMAT_TPT_TINGGAL,KOTA_TPT_TINGGAL,KD_POS_TPT_TINGGAL
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
             upper(#{telpon_rumah2:VARCHAR}),  upper(#{area_code_kantor2:VARCHAR}),  upper(#{telpon_kantor2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            ,  upper(#{area_code_fax:VARCHAR}),  upper(#{mcl_id:VARCHAR}),  upper(#{alamat_rumah:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            ,  upper(#{kd_pos_rumah:VARCHAR}),  upper(#{kota_rumah:VARCHAR}),  upper(#{area_code_rumah:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ,  upper(#{telpon_rumah:VARCHAR}),  upper(#{alamat_kantor:VARCHAR}),  upper(#{kd_pos_kantor:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  upper(#{kota_kantor:VARCHAR}),  upper(#{area_code_kantor:VARCHAR}),  upper(#{telpon_kantor:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  upper(#{email:VARCHAR}),  upper(#{no_hp:VARCHAR}),  upper(#{no_hp2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            ,  upper(#{no_fax:VARCHAR}),  upper(#{area_code_rumah2:VARCHAR}) ,upper(#{alamat_tpt_tinggal:VARCHAR}) ,upper(#{kota_tpt_tinggal:VARCHAR}) ,upper(#{kd_pos_tpt_tinggal:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        )
    </insert>
    
    <update id="updateMstCompany" parameterType="com.app.model.gadget.prod.Personal">
       update eka.mst_company
        set    mcl_id         = #{mcl_id:VARCHAR},
               lju_id         = #{lju_id:INTEGER},
               mpt_usaha_desc = upper(#{mpt_usaha_desc:VARCHAR}),
               mpt_term       = #{mpt_term:INTEGER},
               mpt_npwp       = #{mpt_npwp:VARCHAR},
               mpt_contact    = upper(#{mpt_contact:VARCHAR}),
               lca_id         = #{lca_id:VARCHAR},
               lwk_id         = #{lwk_id:VARCHAR},
               lsrg_id        = #{lsrg_id:VARCHAR},
               lbn_id         = #{lbn_id:INTEGER},
               lsbp_id        = #{lsbp_id:INTEGER},
               tgl_print_inv  = to_date(#{s_tgl_print_inv:VARCHAR},'dd/mm/yyyy'),
               tgl_print_kw   = to_date(#{s_tgl_print_kw:VARCHAR},'dd/mm/yyyy'),
               flag_ws        = #{flag_ws:INTEGER},
               mpt_siup       = #{mpt_siup:VARCHAR},
               mkl_aset       = #{mkl_aset:VARCHAR},
               tgl_siup       = #{tgl_siup:DATE},
               tgl_npwp       = #{tgl_npwp:DATE},
               MPT_NO_ANGGARAN =#{mpt_no_anggaran:VARCHAR},
               MPT_NOTARIS =#{mpt_notaris:VARCHAR},
               MPT_TGL_ANGGARAN =#{mpt_tgl_anggaran:DATE}
        where  mcl_id         = #{mcl_id:VARCHAR}
    </update>
    
    <insert id="insertMstCompany" parameterType="com.app.model.gadget.prod.Personal">
        insert into eka.mst_company (
           mcl_id, lju_id, mpt_usaha_desc, 
           mpt_term, mpt_npwp, mpt_contact, 
           lca_id, lwk_id, lsrg_id, 
           lbn_id, lsbp_id,
           tgl_print_inv,tgl_print_kw,flag_ws,mpt_siup,mkl_aset,tgl_siup,tgl_npwp,MPT_NO_ANGGARAN,MPT_NOTARIS,MPT_TGL_ANGGARAN
           ) 
        values(
           #{mcl_id:VARCHAR}, #{lju_id:INTEGER}, upper(#{mpt_usaha_desc:VARCHAR}), 
           #{mpt_term:INTEGER}, #{mpt_npwp:VARCHAR}, upper(#{mpt_contact:VARCHAR}), 
           #{lca_id:VARCHAR}, #{lwk_id:VARCHAR}, #{lsrg_id:VARCHAR}, 
           #{lbn_id:INTEGER}, #{lsbp_id:INTEGER},
           to_date(#{s_tgl_print_inv:VARCHAR},'dd/mm/yyyy'),to_date(#{s_tgl_print_kw:VARCHAR},'dd/mm/yyyy'),
           #{flag_ws:INTEGER},#{mpt_siup:VARCHAR},#{mkl_aset:VARCHAR}, #{tgl_siup:DATE},#{tgl_npwp:DATE},#{mpt_no_anggaran:VARCHAR},#{mpt_notaris:VARCHAR},#{mpt_tgl_anggaran:DATE})
    </insert>
    
    <update id="updateMstCompanyAddress" parameterType="com.app.model.gadget.prod.Pemegang">
        UPDATE eka.mst_address_new
        <set>
            <if test="alamat_kantor != null"> alamat_kantor = upper(#{alamat_kantor:VARCHAR}), </if>
            <if test="alamat_rumah != null">  alamat_rumah = upper(#{alamat_rumah:VARCHAR}),</if>
            <if test="area_code_fax != null">  area_code_fax = upper(#{area_code_fax:VARCHAR}), </if>
            <if test="area_code_kantor != null">  area_code_kantor = upper(#{area_code_kantor:VARCHAR}), </if>
            <if test="area_code_kantor2 != null"> area_code_kantor2 = upper(#{area_code_kantor2:VARCHAR}), </if>
            <if test="area_code_rumah != null"> area_code_rumah = upper(#{area_code_rumah:VARCHAR}), </if>
            <if test="area_code_rumah2 != null"> area_code_rumah2 = upper(#{area_code_rumah2:VARCHAR}), </if>
            <if test="email != null"> email = upper(#{email:VARCHAR}), </if>
            <if test="kd_pos_kantor != null"> kd_pos_kantor = upper(#{kd_pos_kantor:VARCHAR}), </if>
            <if test="kd_pos_rumah != null"> kd_pos_rumah = upper(#{kd_pos_rumah:VARCHAR}), </if>
            <if test="kota_kantor != null"> kota_kantor = upper(#{kota_kantor:VARCHAR}), </if>
            <if test="kota_rumah != null"> kota_rumah = upper(#{kota_rumah:VARCHAR}),</if>
            <if test="no_fax != null"> no_fax = upper(#{no_fax:VARCHAR}),</if>
            <if test="no_hp != null"> no_hp = upper(#{no_hp:VARCHAR}), </if>
            <if test="no_hp2 != null"> no_hp2 = upper(#{no_hp2:VARCHAR}), </if>
            <if test="telpon_kantor != null"> telpon_kantor = upper(#{telpon_kantor:VARCHAR}), </if>
            <if test="telpon_kantor2 != null"> telpon_kantor2 = upper(#{telpon_kantor2:VARCHAR}), </if>
            <if test="telpon_rumah != null"> telpon_rumah = upper(#{telpon_rumah:VARCHAR}), </if>
            <if test="telpon_rumah2 != null">telpon_rumah2 = upper(#{telpon_rumah2:VARCHAR}) </if>
        </set>
        WHERE MCL_ID = #{mcl_id:VARCHAR}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
    </update>
             
    <insert id="insertMstCompanyAddress" parameterType="com.app.model.gadget.prod.Pemegang">
        INSERT INTO eka.mst_address_new
                    (mcl_id, alamat_rumah,
                     kd_pos_rumah, kota_rumah,
                     area_code_rumah,
                     telpon_rumah, alamat_kantor,
                     kd_pos_kantor, kota_kantor,
                     area_code_kantor,
                     telpon_kantor, email,
                     no_hp, no_hp2,
                     no_fax, area_code_rumah2,
                     telpon_rumah2,
                     area_code_kantor2,
                     telpon_kantor2, area_code_fax
                    )
             VALUES (UPPER (#{mcl_id:VARCHAR}), UPPER (#{alamat_rumah:VARCHAR}),
                     UPPER (#{kd_pos_rumah:VARCHAR}), UPPER (#{kota_rumah:VARCHAR}),
                     UPPER (#{area_code_rumah:VARCHAR}),
                     UPPER (#{telpon_rumah:VARCHAR}), UPPER (#{alamat_kantor:VARCHAR}),
                     UPPER (#{kd_pos_kantor:VARCHAR}), UPPER (#{kota_kantor:VARCHAR}),
                     UPPER (#{area_code_kantor:VARCHAR}),
                     UPPER (#{telpon_kantor:VARCHAR}), UPPER (#{email:VARCHAR}),
                     UPPER (#{no_hp:VARCHAR}), UPPER (#{no_hp2:VARCHAR}),
                     UPPER (#{no_fax:VARCHAR}), UPPER (#{area_code_rumah2:VARCHAR}),
                     UPPER (#{telpon_rumah2:VARCHAR}),
                     UPPER (#{area_code_kantor2:VARCHAR}),
                     UPPER (#{telpon_kantor2:VARCHAR}), UPPER (#{area_code_fax:VARCHAR})
                    )
    </insert>
    
    <update id="updateMstPolicy" parameterType="java.util.HashMap">
        UPDATE EKA.MST_POLICY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            LCA_ID = upper(#{agen.lca_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LKU_ID = upper(#{datausulan.lku_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LSCB_ID = (#{datausulan.lscb_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            LSRE_ID = (#{pemegang.lsre_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            LSRG_ID = upper(#{agen.lsrg_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            LSTP_ID = (#{datausulan.lstp_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
            LWK_ID = upper(#{agen.lwk_id:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            MSPO_AGE = (#{pemegang.mspo_age:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            MSPO_AO = upper(#{pemegang.mspo_ao:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            MSPO_CUSTOMER = upper(#{pemegang.mspo_customer:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            MSPO_FOLLOW_UP = (#{pemegang.mspo_follow_up:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
            MSPO_INSTALLMENT = (#{datausulan.mspo_installment:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            MSPO_INS_PERIOD = (#{datausulan.mspo_ins_period:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MSPO_KOMISI_BII = (#{pemegang.mspo_komisi_bii:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MSPO_NO_BLANKO = upper(#{pemegang.mspo_no_blanko:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            MSPO_PAY_PERIOD = (#{datausulan.mspo_pay_period:INTEGER} ),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            MSPO_POLICY_HOLDER = upper(#{pemegang.mspo_policy_holder:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                              
            MSPO_PRIBADI = (#{pemegang.mspo_pribadi:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            MSPO_REF_BII = (#{pemegang.mspo_ref_bii:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            MSPO_SPAJ_DATE = (#{datausulan.mspo_spaj_date:DATE}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            MSPO_UMUR_BEASISWA = (#{tertanggung.mspo_umur_beasiswa:INTEGER}),
            MSPO_JENIS_TERBIT = (#{pemegang.mspo_jenis_terbit:INTEGER}),
            MSPO_NASABAH_ACC = (#{datausulan.mspo_nasabah_acc:VARCHAR}),           
            MSPO_NASABAH_DCIF = (#{pemegang.mspo_nasabah_dcif:VARCHAR}),           
            MSPO_FLAT = (#{pemegang.mspo_flat:INTEGER}),
            MSPO_PROVIDER = (#{datausulan.mspo_provider:INTEGER}),
            MSPO_LEADER = (#{pemegang.mspo_leader:VARCHAR}),
            MSPO_FLAG_SPH = (#{datausulan.mspo_flag_sph:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            MSPO_SYAHRIAH = (#{datausulan.mspo_syahriah:INTEGER}),
            MSPO_FLAG_NEW = (#{datausulan.mspo_flag_new:INTEGER}),
            MSPO_SPAJ_BUNDLE= (#{pemegang.mspo_spaj_bundle:VARCHAR}),
            MSAG_ASNEW = (#{agen.msag_asnew:INTEGER}),
            MSPO_FLAG_SPAJ=(#{pemegang.mspo_flag_spaj:INTEGER}),
            MSPO_KORESPONDENSI=(#{pemegang.mspo_korespondensi:VARCHAR}),
            NO_PROPOSAL=(#{pemegang.id_proposal:VARCHAR}),
            LEAD_ID=(#{pemegang.lead_id:VARCHAR}),
            CF_JOB_CODE =(#{pemegang.cf_job_code:VARCHAR}),
            CF_CUSTOMER_ID =(#{pemegang.cf_customer_id:VARCHAR}), 
            CF_CAMPAIGN_CODE =(#{pemegang.cf_campaign_code:VARCHAR})
        WHERE REG_SPAJ =  rpad(replace(#{datausulan.reg_spaj:VARCHAR},'.'),11,' ')
    </update>
    
    <insert id="insertMstPolicy" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_POLICY (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
             REG_SPAJ, LSTB_ID, LCA_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            , LWK_ID, LSRG_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            , LSSP_ID , LSPD_ID, MSPO_POLICY_HOLDER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
            , LSRE_ID , MSPO_AGE , LKU_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            , LSCB_ID, LUS_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            , MSPO_SPAJ_DATE, MSPO_INS_PERIOD, MSPO_PAY_PERIOD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            , MSPO_PROSES_BILL,  MSPO_INSTALLMENT , MSPO_REF_BII                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            , MSPO_DATE_PRINT, MSPO_DATE_SPEC , MSPO_DATE_TTP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , MSPO_PRIBADI, MSPO_AO, MSPO_CUSTOMER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , MSPO_NO_BLANKO ,MSPO_UMUR_BEASISWA                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
            , MSPO_FOLLOW_UP, MSPO_KOMISI_BII , MSPO_INPUT_DATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            , MSPO_PROVIDER , LSTP_ID ,MSPO_JENIS_TERBIT  ,MSPO_NASABAH_DCIF, MSPO_FLAT, MSPO_NASABAH_ACC, MSPO_JOINT_POLICY, MSPO_LEADER
            , MSPO_FLAG_SPH , MSPO_SYAHRIAH, MSPO_FLAG_NEW, MSPO_SPAJ_BUNDLE, MSAG_ASNEW, MSPO_FLAG_SPAJ,MSPO_KORESPONDENSI,NO_PROPOSAL, LEAD_ID
            , CF_JOB_CODE, CF_CUSTOMER_ID, CF_CAMPAIGN_CODE
            , mspo_id_sponsor, mspo_id_place
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
             upper(#{datausulan.reg_spaj:VARCHAR}),  1,  upper(#{agen.lca_id:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            ,  upper(#{agen.lwk_id:VARCHAR}),  upper(#{agen.lsrg_id:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            ,  10,  1,  upper(#{pemegang.mspo_policy_holder:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ,  (#{pemegang.lsre_id:INTEGER}),  (#{pemegang.mspo_age:INTEGER}),  upper(#{datausulan.lku_id:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            ,  (#{datausulan.lscb_id:INTEGER}),  (#{datausulan.lus_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            ,  (#{datausulan.mspo_spaj_date:DATE}),  (#{datausulan.mspo_ins_period:INTEGER}),  (#{datausulan.mspo_pay_period:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ,  0,  (#{datausulan.mspo_installment:INTEGER}),  (#{pemegang.mspo_ref_bii:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            ,  (#{datausulan.mspo_date_print:DATE}),  (#{datausulan.mspo_date_spec:DATE}),  (#{datausulan.mspo_date_ttp:DATE})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ,  (#{pemegang.mspo_pribadi:INTEGER}),  upper(#{pemegang.mspo_ao:VARCHAR}),  upper(#{pemegang.mspo_customer:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            ,  upper(#{pemegang.mspo_no_blanko:VARCHAR}) ,(#{tertanggung.mspo_umur_beasiswa:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
            ,  (#{pemegang.mspo_follow_up:INTEGER}),  (#{pemegang.mspo_komisi_bii:INTEGER}), SYSDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  (#{datausulan.mspo_provider:INTEGER}) ,  (#{datausulan.lstp_id:INTEGER})  ,(#{pemegang.mspo_jenis_terbit:INTEGER})  ,#{pemegang.mspo_nasabah_dcif:VARCHAR}, #{pemegang.mspo_flat:INTEGER}, #{datausulan.mspo_nasabah_acc:VARCHAR}, #{datausulan.kopiSPAJ:VARCHAR}, #{pemegang.mspo_leader:VARCHAR}
            ,  (#{datausulan.mspo_flag_sph:INTEGER}) , (#{datausulan.mspo_syahriah:INTEGER}), (#{datausulan.mspo_flag_new:INTEGER}),(#{pemegang.mspo_spaj_bundle:VARCHAR}),  (#{agen.msag_asnew:INTEGER})
            ,  (#{pemegang.mspo_flag_spaj:INTEGER}) , (#{pemegang.mspo_korespondensi:VARCHAR}), (#{pemegang.id_proposal:VARCHAR}), (#{pemegang.lead_id:VARCHAR})
            ,  (#{pemegang.cf_job_code:VARCHAR}) , (#{pemegang.cf_customer_id:VARCHAR}), (#{pemegang.cf_campaign_code:VARCHAR})
            ,  #{pemegang.mspo_id_sponsor:VARCHAR}, #{pemegang.mspo_id_place:VARCHAR})
    </insert>
    
    <update id="updateLeadReffBii" parameterType="java.util.HashMap">
        update eka.mst_policy set mspo_plan_provider = #{kode:VARCHAR} where reg_spaj = rpad(replace(#{spaj:VARCHAR},'.'),11,' ')
    </update>
    
    <update id="updateMstTransHistory" parameterType="java.util.HashMap">
        UPDATE eka.mst_trans_history                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        SET ${kolom_tgl} = #{tgl:DATE}
            <if test="kolom_user != null">
                , ${kolom_user} = #{lus_id:VARCHAR}
            </if>           
        WHERE reg_spaj = rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
            and jenis = 23
    </update>   
    
    <insert id="insertMstTransHistory" parameterType="java.util.HashMap">
        INSERT INTO eka.mst_trans_history
            ( reg_spaj, jenis, trans_ke, trans_ke2, ${kolom_tgl}
            <if test="kolom_user != null">
                , ${kolom_user}
            </if>
            )
        VALUES
            ( #{reg_spaj:VARCHAR}, 23, 1, 1, #{tgl:DATE}
            <if test="kolom_user != null">
            , #{lus_id:VARCHAR}
            </if>
            )
    </insert>
        
    <update id="updateBungaMstPolicy" parameterType="com.app.model.gadget.prod.Pemegang">
        UPDATE EKA.MST_POLICY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        MSPO_UNDER_TABLE = #mspo_under_table#                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
        WHERE REG_SPAJ = rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
    </update>
    
     <delete id="deleteMstKyc" parameterType="java.util.HashMap">
        DELETE  eka.mst_kyc 
         WHERE reg_spaj = #{reg_spaj:VARCHAR} and kyc_id=#{kyc:VARCHAR} and kyc_pp=#{kyc_pp:VARCHAR}
    </delete>
    
    <insert id="insertKyc" parameterType="java.util.HashMap">
        INSERT INTO eka.mst_kyc
               (reg_spaj, no_urut, kyc_id, kyc_pp, kyc_desc)
        VALUES (#{reg_spaj:VARCHAR}, #{no_urut:INTEGER}, #{kyc_id:VARCHAR}, #{kyc_pp:VARCHAR}, upper(#{kyc_desc:VARCHAR}))
    </insert>
    
    <update id="updateMonitoringSpaj" parameterType="java.util.HashMap">
        update eka.mst_spaj_ao 
        <choose>
            <when test="type =='old'">
            set id_dok = 'XX'||#{value:VARCHAR}, flag_active = 0, update_date = sysdate 
            where id_dok = #value# and lstb_id = 1 and jenis = #{jenis:INTEGER}
            </when>
            <when test="type =='new'">
            set flag_further = null , update_date = sysdate 
            where id_dok = #{value:VARCHAR} and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1
            </when>
            <when test="type =='update_further'">
                <if test="tgl_kembali_ke_agen != null">
                    set update_date = sysdate, tgl_kembali_ke_agen = #{tgl_kembali_ke_agen:DATE}, tgl_terima_dari_agen = #{tgl_terima_dari_agen:DATE}, flag_further = null, jenis_further = #{jenis_further:VARCHAR}, keterangan_further = #{keterangan_further:VARCHAR}
                    where id_dok = #{value:VARCHAR} and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1 and flag_further = 1 and (tgl_kembali_ke_agen is null or tgl_terima_dari_agen is null)
                </if>
                <if test="tgl_kembali_ke_agen == null">
                    set update_date = sysdate, tgl_terima_dari_agen = #{tgl_terima_dari_agen:DATE}
                    where id_dok = #{value:VARCHAR} and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1 and flag_further = 1 and (tgl_kembali_ke_agen is null or tgl_terima_dari_agen is null)
                </if>           
            </when>
            <when test="type =='update_to_further'">
            set update_date = sysdate,  flag_further = 1, tgl_further = sysdate 
            where id_dok = #{value:VARCHAR} and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1
            </when>
            <when test="type =='update'">
            set update_date = sysdate,  flag_further = 2 
            where id_dok = #{value:VARCHAR} and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1
            </when>
            <when test="type =='update_NF_to_further'">
            set msag_id =  #{msag_id:VARCHAR} ,name_customer = upper(#{nama_pemegang:VARCHAR}), tgl_further = sysdate , update_date = sysdate,  flag_further = 1, tgl_kembali_ke_agen = #{tgl_kembali_ke_agen:DATE}, tgl_terima_dari_agen = #{tgl_terima_dari_agen:DATE}, email_cc= #{emailcc:VARCHAR}, jenis_further = #{jenis_further:VARCHAR}, keterangan_further = #{keterangan_further:VARCHAR}
            where id_dok = #{value:VARCHAR} and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1
            </when>
            <when test="type =='edit_data_further'">
            set name_customer = upper(#{nama_pemegang:VARCHAR}), update_date = sysdate,tgl_kembali_ke_agen = #{tgl_kembali_ke_agen:DATE}, tgl_terima_dari_agen =#{tgl_terima_dari_agen:DATE}, email_cc= #{emailcc:VARCHAR}, jenis_further = #{jenis_further:VARCHAR}, keterangan_further = #{keterangan_further:VARCHAR}
            where id_dok = #{value:VARCHAR}  and lstb_id = 1 and jenis = #{jenis:INTEGER} and flag_active = 1 and flag_further = 1
            </when>
            <when test="type =='update_further_to_NF_inputSpaj'">
            set update_date = sysdate,flag_further = null, reg_spaj = #{emailcc:VARCHAR}, tgl_terima_dari_agen =sysdate
                where id_dok = #{value:VARCHAR} and lstb_id = 1 and flag_active = 1 
            </when> 
        </choose>
    </update>
    
    <update id="updateMstWorksiteFlag" parameterType="com.app.model.gadget.prod.Pemegang">
        UPDATE EKA.MST_WORKSITE_FLAG                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            NIK= upper(#{nik:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
        WHERE REG_SPAJ = rpad(replace(#{reg_spaj:VARCHAR} ,'.'),11,' ')
    </update>
    
    <insert id="insertMstWorksiteFlag" parameterType="com.app.model.gadget.prod.Pemegang">
        INSERT INTO EKA.MST_WORKSITE_FLAG
            (REG_SPAJ,NIK)
        VALUES
            (#{reg_spaj:VARCHAR},#{nik:VARCHAR})
    </insert>
        
    <update id="update_Counter" parameterType="java.util.HashMap">
        UPDATE EKA.MST_COUNTER 
        SET EKA.MST_COUNTER.MSCO_VALUE = #{IDCounter:NUMERIC} 
        WHERE EKA.MST_COUNTER.MSCO_NUMBER = #{number:INTEGER} AND 
              EKA.MST_COUNTER.LCA_ID = #{lca_id:VARCHAR}
    </update>
    
    <update id="update_no_blanko" parameterType="java.util.HashMap">
        update eka.mst_spaj_det set lsp_id=3 , reg_spaj=#{spaj:VARCHAR}
        where no_blanko=#{no_blanko:VARCHAR} and lsjs_id=#{lsjs_id:INTEGER}
    </update>
    
    <update id="updateMstInsured" parameterType="java.util.HashMap">
        UPDATE EKA.MST_INSURED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            MSTE_AGE = (#{tertanggung.mste_age:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            MSTE_BEG_DATE = (#{datausulan.mste_beg_date:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            MSTE_DEWASA = (#{pemegang.mste_dewasa:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            MSTE_END_DATE = (#{datausulan.mste_end_date:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            MSTE_FLAG_CC = (#{datausulan.mste_flag_cc:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            MSTE_INSURED = upper(#{tertanggung.mste_insured:VARCHAR}),   
            MSTE_TGL_RECUR = (#{pemegang.mste_tgl_recur:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            MSTE_MEDICAL = (#{datausulan.mste_medical:INTEGER}) ,
            MSTE_PCT_DPLK = (#{pemegang.mste_pct_dplk:DOUBLE}),
            MSTE_FLAG_EL  = (#{datausulan.mste_flag_el:INTEGER})   ,
            MSTE_FLAG_INVESTASI = (#{datausulan.mste_flag_investasi:INTEGER}) ,
            MSTE_FLAG_GUTHRIE = (#{pemegang.mste_flag_guthrie:INTEGER}) ,                         
            MSTE_SPAJ_ASLI = (#{pemegang.mste_spaj_asli:INTEGER}),
            MSTE_FLAG_REF_TELEMARKET = upper(#{tertanggung.mste_flag_ref_telemarket:INTEGER}),
            MSTE_FLAG_SPECIAL_OFFER = (#{tertanggung.mste_flag_special_offer:INTEGER}),
            MSTE_FLAG_HADIAH = (#{tertanggung.mste_flag_hadiah:INTEGER}),
            FLAG_PACKET = (#{datausulan.flag_paket:INTEGER}),
            REG_SPAJ_PACKET = (#{datausulan.spaj_paket:VARCHAR}),
            MSTE_DTH = (#{tertanggung.mste_dth:INTEGER}),
            MSTE_GMIT  = (#{datausulan.mste_gmit:INTEGER}),
            MSTE_NO_VACC=(#{tertanggung.mste_no_vacc:VARCHAR})
            WHERE REG_SPAJ =  rpad(replace(#{datausulan.reg_spaj:VARCHAR},'.'),11,' ')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            AND MSTE_INSURED_NO = 1
    </update>
    
    <insert id="insertMstInsured" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_INSURED (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                REG_SPAJ, MSTE_INSURED_NO, MSTE_INSURED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                , MSTE_AGE, MSTE_MEDICAL, MSTE_STANDARD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                , LSPD_ID , LUS_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                , MSTE_BEG_DATE, MSTE_END_DATE , MSTE_INPUT_DATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                , MSTE_BACKUP, LSSA_ID, MSTE_REAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                , MSTE_ACTIVE, MSTE_DEWASA, MSTE_FLAG_CC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                , MSTE_TGL_RECUR, MSTE_PCT_DPLK , MSTE_FLAG_EL  ,MSTE_FLAG_INVESTASI,
                MSTE_FLAG_GUTHRIE, MSTE_SPAJ_ASLI, MSTE_FLAG_REF_TELEMARKET, mste_flag_special_offer,mste_flag_hadiah, 
                flag_packet, reg_spaj_packet, mste_dth, mste_gmit,mste_no_vacc
            ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                 upper(#{datausulan.reg_spaj:VARCHAR}),  1,  upper(#{tertanggung.mste_insured:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                ,  (#{tertanggung.mste_age:INTEGER}),  (#{datausulan.mste_medical:INTEGER}),  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                ,  1,  (#{pemegang.lus_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                ,  (#{datausulan.mste_beg_date:DATE}),  (#{datausulan.mste_end_date:DATE}),  SYSDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                ,  0,(#{datausulan.lssa_id:INTEGER}),0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                ,  1,  (#{pemegang.mste_dewasa:INTEGER}),  (#{datausulan.mste_flag_cc:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                ,  (#{pemegang.mste_tgl_recur:DATE}) ,    (#{pemegang.mste_pct_dplk:DOUBLE})  ,(#{datausulan.mste_flag_el:INTEGER}) ,(#{datausulan.mste_flag_investasi:INTEGER}),
                (#{pemegang.mste_flag_guthrie:INTEGER}), #{pemegang.mste_spaj_asli:INTEGER}, #{tertanggung.mste_flag_ref_telemarket:INTEGER}, #{tertanggung.mste_flag_special_offer:INTEGER},#{tertanggung.mste_flag_hadiah:INTEGER},
                (#{datausulan.flag_paket:INTEGER}), (#{datausulan.spaj_paket:VARCHAR}), (#{tertanggung.mste_dth:INTEGER}), (#{datausulan.mste_gmit:INTEGER}),(#{tertanggung.mste_no_vacc:VARCHAR})
            )
    </insert>
    
    <delete id="deleteMstKeluarga" parameterType="java.lang.String" >
        delete from eka.mst_keluarga where reg_spaj = rpad(replace(#{value:VARCHAR},'.'),11,' ')
    </delete>   
        
    <insert id="insertMstKeluarga" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_KELUARGA
            (REG_SPAJ, NAMA, LSRE_ID, TANGGAL_LAHIR, INSURED, NO, USIA,
             KERJA, NAMA_PERUSAHAAN, BIDANG_USAHA, NPWP, PENGHASILAN, LJB_ID)
        VALUES
            (#{strTmpSPAJ:VARCHAR}, upper(#{nama:VARCHAR}), #{lsre_id:INTEGER}, #{tanggal_lahir:DATE}, #{insured:INTEGER}, #{no:INTEGER}, #{usia:INTEGER},
             upper(#{pekerjaan:VARCHAR}), upper(#{nama_perusahaan:VARCHAR}), upper(#{bidang:VARCHAR}), #{npwp:VARCHAR}, #{penghasilan:VARCHAR}, #{jabatan:INTEGER})
    </insert>
    
    <update id="updateMstKeluarga" parameterType="java.util.HashMap">
        UPDATE eka.mst_keluarga
        SET nama = upper(#{nama:VARCHAR}),
            lsre_id = #{lsre_id:VARCHAR},
            tanggal_lahir = #{tanggal_lahir:DATE},      
            usia = #{usia:INTEGER},
            kerja = upper(#{pekerjaan:VARCHAR}),
            nama_perusahaan = upper(#{nama_perusahaan:VARCHAR}),
            bidang_usaha = upper(#{bidang:VARCHAR}),
            npwp = #{npwp:VARCHAR},
            penghasilan = #{penghasilan:VARCHAR},
            ljb_id = #{jabatan:VARCHAR}
        WHERE reg_spaj = #{strTmpSPAJ:VARCHAR}
            and no = #{no:INTEGER}
    </update>
    
    <update id="updateNewClientPayerBadanHukum" parameterType="com.app.model.gadget.prod.PembayarPremi">
        UPDATE eka.mst_client_new 
        SET mcl_first = upper(#{nama_pihak_ketiga:VARCHAR}),
            mcl_jenis = #{mcl_jenis:VARCHAR},
            tgl_pendirian_payer = #{mspe_date_birth_3rd:DATE},
            tpt_kedudukan_payer = upper(#{tempat_lahir:VARCHAR}) ,
            mkl_kerja = #{pekerjaan:VARCHAR},
            ljb_id = #{jabatan:VARCHAR},
            mcl_npwp = #{no_npwp:VARCHAR},
            mkl_pendanaan = #{sumber_dana:VARCHAR} ,
            mkl_tujuan = #{tujuan_dana:VARCHAR}
        WHERE mcl_id = #{mcl_id:VARCHAR}
    </update>       
    
    <insert id="insertNewClientPayerBadanHukum" parameterType="com.app.model.gadget.prod.PembayarPremi">
        INSERT INTO eka.mst_client_new
               (mcl_id,
                mcl_jenis,
                mcl_first,
                mspe_email,
                mcl_npwp,
                mkl_pendanaan,
                mkl_tujuan,
                tgl_pendirian_payer,
                tpt_kedudukan_payer,
                mcl_company_payer,
                lti_id,
                mkl_industri
                )
        VALUES (#{mcl_id:VARCHAR},
               #{mcl_jenis:VARCHAR},
                upper(#{nama_pihak_ketiga:VARCHAR}),
                upper(#{email:VARCHAR}),
                #{no_npwp:VARCHAR},
                #{sumber_dana:VARCHAR},
                #{tujuan_dana:VARCHAR},
                #{mspe_date_birth_3rd_pendirian:DATE},
                upper(#{tempat_kedudukan:VARCHAR}),
                upper(#{perusahaan:VARCHAR}),
                #{bidang_usaha_badan_hukum:VARCHAR},
                #{bidang_usaha_pembayar_premi:VARCHAR}
                )
    </insert>
    
    <update id="updateAddressPemPremiIndividu" parameterType="com.app.model.gadget.prod.PembayarPremi">
        UPDATE eka.mst_address_new
        SET alamat_rumah =  upper(#{alamat_lengkap:VARCHAR}),
            area_code_kantor = #{area_code_kantor_3rd:VARCHAR},
            telpon_kantor =  #{telp_kantor:VARCHAR},
            area_code_rumah =  #{area_code_3rd:VARCHAR},
            telpon_rumah = #{telp_rumah:VARCHAR},
            alamat_3rd = upper(#{alamat_lengkap:VARCHAR}),
            area_code_kantor_3rd = #{area_code_kantor_3rd:VARCHAR},
            telpon_kantor_3rd =  #{telp_kantor:VARCHAR},
            lspr_id = #{kewarganegaraan:VARCHAR}
        WHERE mcl_id = #{mcl_id:VARCHAR}
    </update>
    
    <insert id="insertAddressPemPremiBadanHukum" parameterType="com.app.model.gadget.prod.PembayarPremi">
        INSERT INTO eka.mst_address_new
            (mcl_id,
            alamat_kantor,
            area_code_kantor,
            telpon_kantor,
            area_code_fax,
            no_fax,
            lspr_id,
            kd_pos_kantor,
            kota_kantor,
            alamat_3rd,
            telpon_kantor_3rd
            )
        VALUES
            (#{mcl_id:VARCHAR},
            upper(#{alamat_perusahaan:VARCHAR}),
            #{area_code_perusahaan:VARCHAR},
            #{telp_perusahaan:VARCHAR},                 
            #{area_code_fax_perusahaan:VARCHAR},
            #{faks_perusahaan:VARCHAR},
            #{prov_perusahaan:VARCHAR},
            #{kdpos_perusahaan:VARCHAR},
            #{kota_perusahaan:VARCHAR},
            upper(#{alamat_perusahaan:VARCHAR},),
            #{telp_kantor:VARCHAR}
            )
    </insert>
    
    <update id="updateMstPolicyPayer" parameterType="java.util.HashMap">
        UPDATE eka.mst_policy
         SET mspo_payer = #{mspo_payer:VARCHAR} ,lsre_id_payer =#{lsre:VARCHAR} 
         WHERE reg_spaj =#{reg_spaj:VARCHAR}
    </update>
    
    <update id="updateNewClientPayerIndividu" parameterType="com.app.model.gadget.prod.PembayarPremi">
        UPDATE eka.mst_client_new 
        SET  mcl_jenis =  #{mcl_jenis:VARCHAR},
             mcl_first = upper(#{nama_pihak_ketiga:VARCHAR}),
             mspe_email = upper(#{email:VARCHAR}),
             mspe_date_birth =  #{mspe_date_birth_3rd:DATE},
             mspe_place_birth = upper(#{tempat_lahir:VARCHAR}),
             mkl_kerja = #{pekerjaan:VARCHAR},
             ljb_id = #{jabatan:VARCHAR},
             mcl_npwp =  #{no_npwp:VARCHAR},
             mkl_pendanaan = #{sumber_dana:VARCHAR},
             mkl_tujuan = #{tujuan_dana:VARCHAR},
             mkl_industri = #{bidang_usaha_individu:VARCHAR},
             mkl_instansi_payer = #{instansi:VARCHAR}
        WHERE mcl_id = #{mcl_id:VARCHAR}
    </update>       
    
    <insert id="insertNewClientPayerIndividu" parameterType="com.app.model.gadget.prod.PembayarPremi">
        INSERT INTO eka.mst_client_new
               (mcl_id,
                mcl_jenis,
                mcl_first,
                mspe_email,
                mspe_date_birth,
                mspe_place_birth,
                mkl_kerja,
                ljb_id,
                mcl_npwp,
                mkl_pendanaan,
                mkl_tujuan,
                mkl_industri,
                mkl_instansi_payer,
                mcl_tgl_input
                )
        VALUES (#{mcl_id:VARCHAR},
                #{mcl_jenis:VARCHAR}, 
                upper(#{nama_pihak_ketiga:VARCHAR}),
                upper(#{email:VARCHAR}),
                #{mspe_date_birth_3rd:DATE},
                upper(#{tempat_lahir:VARCHAR}),
                #{pekerjaan:VARCHAR},
                #{jabatan:VARCHAR},
                #{no_npwp:VARCHAR},
                #{sumber_dana:VARCHAR},
                #{tujuan_dana:VARCHAR},
                #{bidang_usaha_individu:VARCHAR},
                #{instansi:VARCHAR},
                sysdate
                )
    </insert>
    
    <insert id="insertAddressPemPremiIndividu" parameterType="com.app.model.gadget.prod.PembayarPremi">
        INSERT INTO eka.mst_address_new
               (mcl_id,
                alamat_rumah,
                area_code_kantor,
                telpon_kantor,
                area_code_rumah,
                telpon_rumah,
                alamat_3rd,
                area_code_kantor_3rd,
                telpon_kantor_3rd,
                lspr_id
                )
        VALUES
               (#{mcl_id:VARCHAR},
                upper(#{alamat_lengkap:VARCHAR}),
                #{area_code_kantor_3rd:VARCHAR},
                #{telp_kantor:VARCHAR},
                #{area_code_3rd:VARCHAR},
                #{telp_rumah:VARCHAR},
                upper(#{alamat_lengkap:VARCHAR}),
                #{area_code_kantor_3rd:VARCHAR},
                #{telp_kantor:VARCHAR},
                #{kewarganegaraan:VARCHAR}
               )
    </insert>   
    
    <update id="updateMstClientPic" parameterType="com.app.model.gadget.prod.ContactPerson">
    update eka.mst_company_contact
            set    flag_ut = #{flag_ut:INTEGER},
                   nama_lengkap    = upper(#{nama_lengkap:VARCHAR}),
                   telp_kantor     = #{telp_kantor:VARCHAR},
                   telp_hp         = #{telp_hp:VARCHAR},
                   email           = upper(#{email:VARCHAR}),
                   cara_bayar      = #{cara_bayar:INTEGER},
                   rek_no          = #{rek_no:VARCHAR},
                   rek_nama        = upper(#{rek_nama:VARCHAR}),
                   rek_bank        = upper(#{rek_bank:VARCHAR}),
                   rek_bank_cabang = upper(#{rek_bank_cabang:VARCHAR}),
                   rek_bank_kota   = upper(#{rek_bank_kota:VARCHAR}),
                   lus_id          = #{lus_id:INTEGER},
                   input_date      = #{input_date:DATE},
                   mste_sex        = #{mste_sex:INTEGER},
                   lti_id          = #{lti_id:INTEGER}, 
                   mcl_gelar       = upper(#{mcl_gelar:VARCHAR}), 
                   mspe_mother     = upper(#{mspe_mother:VARCHAR}),
                   ljb_id          = #{ljb_id:VARCHAR},
                   mpn_job_desc    = upper(#{mpn_job_desc:VARCHAR}),
                   lama_kerja      = #{lama_kerja:INTEGER},
                   lside_id        = #{lside_id:INTEGER},
                   no_identity     = upper(#{no_identity:VARCHAR}),
                   lsne_id         = #{lsne_id:INTEGER},
                   date_birth      = #{date_birth:DATE},
                   mste_age        = #{mste_age:INTEGER},
                   place_birth     = upper(#{place_birth:VARCHAR}),
                   sts_mrt         = #{sts_mrt:VARCHAR},
                   agama           = upper(#{agama:VARCHAR}),
                   lsed_id         = #{lsed_id:INTEGER},
                   lsag_id         = #{lsag_id:INTEGER},
                   pic_jenis       = #{pic_jenis:INTEGER},
                   lsre_id         = #{lsre_id:INTEGER},
                   no_identity_expired     = #{no_identity_expired:DATE}
            where  mcl_id          = #{mcl_id:VARCHAR} and no_urut = #{no_urut:INTEGER}  
    </update>
    
    <insert id="insertMstClientPic" parameterType="com.app.model.gadget.prod.ContactPerson">
        insert into eka.mst_company_contact (
           mcl_id, no_urut, flag_ut, nama_lengkap, telp_kantor, 
           telp_hp, email, cara_bayar, 
           rek_no, rek_nama, rek_bank, 
           rek_bank_cabang, rek_bank_kota, lus_id, 
           input_date,mste_sex,
           lti_id, mcl_gelar, mspe_mother, ljb_id, mpn_job_desc, 
           lama_kerja, lside_id, no_identity, lsne_id, date_birth, 
           mste_age, place_birth, sts_mrt, agama, lsed_id, lsag_id, pic_jenis, lsre_id, no_identity_expired) 
        values (
           #{mcl_id:VARCHAR}, #{no_urut:INTEGER}, #{flag_ut:INTEGER}, upper(#{nama_lengkap:VARCHAR}), #{telp_kantor:VARCHAR}, 
           #{telp_hp:VARCHAR}, upper(#{email:VARCHAR}), #{cara_bayar:INTEGER}, 
           #{rek_no:VARCHAR}, upper(#{rek_nama:VARCHAR}), #{rek_bank:VARCHAR}, 
           upper(#{rek_bank_cabang:VARCHAR}), upper(#{rek_bank_kota:VARCHAR}), #{lus_id:INTEGER}, 
           sysdate,#{mste_sex:INTEGER},
           #{lti_id:INTEGER}, #{mcl_gelar:VARCHAR}, #{mspe_mother:VARCHAR}, #{ljb_id:VARCHAR}, #{mpn_job_desc:VARCHAR}, 
           #{lama_kerja:INTEGER}, #{lside_id:INTEGER}, #{no_identity:VARCHAR}, #{lsne_id:INTEGER}, #{date_birth:DATE}, 
           #{mste_age:INTEGER}, #{place_birth:VARCHAR}, #{sts_mrt:VARCHAR}, #{agama:VARCHAR}, #{lsed_id:INTEGER}, #{lsag_id:INTEGER}, #{pic_jenis:INTEGER}, #{lsre_id:INTEGER}, #{no_identity_expired:DATE})
    </insert>
    
    <update id="updateMstAddressPic" parameterType="com.app.model.gadget.prod.ContactPerson">
        UPDATE eka.mst_company_contact_address                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ALAMAT_KANTOR = upper(#{alamat_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ALAMAT_RUMAH = upper(#{alamat_rumah:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            AREA_CODE_FAX = upper(#{area_code_fax:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            AREA_CODE_KANTOR = upper(#{area_code_kantor:VARCHAR})  ,                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            AREA_CODE_KANTOR2 = upper(#{area_code_kantor2:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            AREA_CODE_RUMAH = upper(#{area_code_rumah:VARCHAR})  ,                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            AREA_CODE_RUMAH2 = upper(#{area_code_rumah2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            EMAIL = upper(#{email:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            KD_POS_KANTOR = upper(#{kd_pos_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            KD_POS_RUMAH = upper(#{kd_pos_rumah:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            KOTA_KANTOR = upper(#{kota_kantor:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            KOTA_RUMAH = upper(#{kota_rumah:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            NO_FAX = upper(#{no_fax:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            NO_HP = upper(#{no_hp:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            NO_HP2 = upper(#{no_hp2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            TELPON_KANTOR = upper(#{telpon_kantor:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            TELPON_KANTOR2 = upper(#{telpon_kantor2:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            TELPON_RUMAH = upper(#{telpon_rumah:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            TELPON_RUMAH2 = upper(#{telpon_rumah2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
        WHERE MCL_ID = upper(#{mcl_id:VARCHAR})
    </update>   
    
    <insert id="insertMstAddressPic" parameterType="com.app.model.gadget.prod.ContactPerson">
        INSERT INTO eka.mst_company_contact_address (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            TELPON_RUMAH2 , AREA_CODE_KANTOR2, TELPON_KANTOR2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            , AREA_CODE_FAX, MCL_ID, ALAMAT_RUMAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            , KD_POS_RUMAH, KOTA_RUMAH, AREA_CODE_RUMAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            , TELPON_RUMAH, ALAMAT_KANTOR, KD_POS_KANTOR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , KOTA_KANTOR, AREA_CODE_KANTOR, TELPON_KANTOR                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            , EMAIL, NO_HP, NO_HP2
            , NO_FAX, AREA_CODE_RUMAH2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
             upper(#{telpon_rumah2:VARCHAR}),  upper(#{area_code_kantor2:VARCHAR}),  upper(#{telpon_kantor2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            ,  upper(#{area_code_fax:VARCHAR}),  upper(#{mcl_id:VARCHAR}),  upper(#{alamat_rumah:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            ,  upper(#{kd_pos_rumah:VARCHAR}),  upper(#{kota_rumah:VARCHAR}),  upper(#{area_code_rumah:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ,  upper(#{telpon_rumah:VARCHAR}),  upper(#{alamat_kantor:VARCHAR}),  upper(#{kd_pos_kantor:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  upper(#{kota_kantor:VARCHAR}),  upper(#{area_code_kantor:VARCHAR}),  upper(#{telpon_kantor:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            ,  upper(#{email:VARCHAR}),  upper(#{no_hp:VARCHAR}),  upper(#{no_hp2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
            ,  upper(#{no_fax:VARCHAR}),  upper(#{area_code_rumah2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
        )                       
    </insert>
    
    <delete id="deleteMstCompanyContactFamily" parameterType="java.lang.String">
        delete from eka.mst_company_contact_family where mcl_id = #{value:VARCHAR}
    </delete>
    
    <insert id="inserMstCompanyContactFamily" parameterType="java.util.HashMap">
        INSERT INTO eka.mst_company_contact_family
        (MCL_ID,NAMA,LSRE_ID,TANGGAL_LAHIR,NO)
        VALUES
        (#{mcl_id:VARCHAR},#{nama:VARCHAR},#{lsre_id:INTEGER},#{tanggal_lahir:DATE},#{no:INTEGER})
    </insert>
        
    <insert id="insertMstAgentProd" parameterType="com.app.model.gadget.prod.Agen">
        INSERT INTO EKA.MST_AGENT_PROD
                (REG_SPAJ, LSTB_ID, MSAG_ID, LSLE_ID
            <if test="lev_comm != null">, LEV_COMM</if>
            ,FLAG_SBM, LVL_FCD)
                        VALUES
                            (upper(#{reg_spaj:VARCHAR}) , (#{lstb_id:INTEGER}),  upper(#{msag_id:VARCHAR}) , (#{lsle_id:INTEGER}) 
                            <if test="lev_comm != null">,  (#{lev_comm:INTEGER}) </if>
                            ,(#{flag_sbm:INTEGER}), (#{lvl_fcd:INTEGER})  )
    </insert>

    <insert id="insertMstAgentComm" parameterType="com.app.model.gadget.prod.Agen">
        INSERT INTO EKA.MST_AGENT_COMM
            (REG_SPAJ
            <if test="lev_comm != null">, LEV_COMM</if>
            , MSAG_ID)
        VALUES
            (upper(#{reg_spaj:VARCHAR})  
            <if test="lev_comm != null">, (#{lev_comm:INTEGER}) </if>
            , upper(#{msag_id:VARCHAR}) )
    </insert>   
    
    <insert id="insertMstAgentArtha" parameterType="com.app.model.gadget.prod.Agen">
        INSERT INTO EKA.MST_AGENT_ARTHA
            (REG_SPAJ, MSAG_ID, LSLA_ID, LEV_COMM)
        VALUES
            (#{reg_spaj:VARCHAR}, #{msag_id:VARCHAR}, #{lsla_id:INTEGER}, #{lev_comm:INTEGER})
    </insert>
        
    <insert id="insertMstAgentRekruter" parameterType="com.app.model.gadget.prod.Agen">
                INSERT INTO EKA.MST_AGENT_REKRUTER
                    (REG_SPAJ, NO_URUT, MSAG_ID, LSLE_ID, LEV_REKRUTER)
                VALUES
                (upper(#{reg_spaj:VARCHAR}) , (#{no_urut:INTEGER}),  upper(#{msag_id:VARCHAR}) , (#{lsle_id:INTEGER}), (#{msrk_level:INTEGER})  )
    </insert>
    
    <insert id="insertMstAgentBa" parameterType="com.app.model.gadget.prod.Agen">
        INSERT INTO EKA.MST_AGENT_BA
                (REG_SPAJ, LSTB_ID, MSAG_ID, LSLE_ID
                <if test="lev_comm != null">, LEV_COMM</if>
                ,FLAG_SBM)
        VALUES
                (upper(#{reg_spaj:VARCHAR}) , (#{lstb_id:INTEGER}) , upper(#{msag_id:VARCHAR}) , (#{lsle_id:INTEGER})
                <if test="lev_comm != null">, (#{lev_comm:INTEGER})</if>
            ,(#{flag_sbm:INTEGER}) )
    </insert>   
    
    <update id="updateMstAddressBilling" parameterType="com.app.model.gadget.prod.AddressBilling">
        UPDATE EKA.MST_ADDRESS_BILLING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
        SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            E_MAIL = upper(#{e_mail:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            FLAG_CC = (#{flag_cc:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            KOTA = upper(#{kota:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            LCA_ID = upper(#{lca_id:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            LSKA_ID = (#{lska_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            LSRG_ID = upper(#{lsrg_id:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            LWK_ID = upper(#{lwk_id:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            MSAP_ADDRESS = upper(#{msap_address:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            MSAP_AREA_CODE1 = upper(#{msap_area_code1:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                
            MSAP_AREA_CODE2 = upper(#{msap_area_code2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            MSAP_AREA_CODE3 = upper(#{msap_area_code3:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            MSAP_AREA_CODE_FAX1 = upper(#{msap_area_code_fax1:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            MSAP_FAX1 = upper(#{msap_fax1:VARCHAR}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
            MSAP_PHONE1 = upper(#{msap_phone1:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
            MSAP_PHONE2 = upper(#{msap_phone2:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
            MSAP_PHONE3 = upper(#{msap_phone3:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
            MSAP_ZIP_CODE = upper(#{msap_zip_code:VARCHAR}) , 
            LSNE_ID = upper(#{lsne_id:INTEGER}) ,                                                                                                                                                                                                                                                                                                                                                                                                                                           
            NO_HP = upper(#{no_hp:VARCHAR}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
            NO_HP2 = upper(#{no_hp2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        WHERE REG_SPAJ =     rpad(replace(#{reg_spaj:VARCHAR} ,'.'),11,' ')
    </update>   
    
    <insert id="insertMstAddressBilling" parameterType="com.app.model.gadget.prod.AddressBilling">
        INSERT INTO EKA.MST_ADDRESS_BILLING (                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            KOTA, NO_HP2, NO_HP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            , REG_SPAJ, LSKA_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            , MSAP_ADDRESS, MSAP_ZIP_CODE , MSAP_AREA_CODE1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            , MSAP_PHONE1, MSAP_AREA_CODE2, MSAP_PHONE2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            , MSAP_AREA_CODE3, MSAP_PHONE3, MSAP_AREA_CODE_FAX1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
            , MSAP_FAX1 , LCA_ID, LWK_ID , LSRG_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            , FLAG_CC, E_MAIL, LSNE_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
        ) values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
             upper(#{kota:VARCHAR}),  upper(#{no_hp2:VARCHAR}),  upper(#{no_hp:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
            ,  upper(#{reg_spaj:VARCHAR}), (#{lska_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
            ,  upper(#{msap_address:VARCHAR}),  upper(#{msap_zip_code:VARCHAR}),  upper(#{msap_area_code1:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            ,  upper(#{msap_phone1:VARCHAR}),  upper(#{msap_area_code2:VARCHAR}),  upper(#{msap_phone2:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ,  upper(#{msap_area_code3:VARCHAR}),  upper(#{msap_phone3:VARCHAR}),  upper(#{msap_area_code_fax1:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
            ,  upper(#{msap_fax1:VARCHAR}) ,  upper(#{lca_id:VARCHAR}),  upper(#{lwk_id:VARCHAR}),  upper(#{lsrg_id:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            ,  (#{flag_cc:INTEGER}),  upper(#{e_mail:VARCHAR}), (#{lsne_id:INTEGER})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
        )            
    </insert>
    
    <update id="updateMstRekClient" parameterType="com.app.model.gadget.prod.Rekening_client">
        UPDATE eka.mst_rek_client
        <trim prefix="SET" suffixOverrides=",">
            <if test="tgl_change != null">tgl_change = sysdate, </if>
            <if test="lus_id != null">lus_id =  #{lus_id:INTEGER}, </if>
            <if test="lsbp_id != null">lsbp_id = #{lsbp_id:VARCHAR}, </if>
            <if test="mrc_cabang != null">mrc_cabang = upper(#{mrc_cabang:VARCHAR}), </if>
            <if test="mrc_jenis != null">mrc_jenis = #{mrc_jenis:INTEGER}, </if>
            <if test="mrc_jn_nasabah != null">mrc_jn_nasabah = #{mrc_jn_nasabah:INTEGER}, </if>
            <if test="mrc_kota != null">mrc_kota = upper(#{mrc_kota:VARCHAR}), </if>
            <if test="mrc_kurs != null">mrc_kurs = upper(#{mrc_kurs:VARCHAR}), </if>
            <if test="mrc_nama != null">mrc_nama = upper(#{mrc_nama:VARCHAR}), </if>
            <if test="mrc_no_ac != null">mrc_no_ac = upper(#{mrc_no_ac:VARCHAR}), </if>
            <if test="mrc_kuasa != null">mrc_kuasa = upper(#{mrc_kuasa:INTEGER}), </if>
            <if test="tgl_surat != null">tgl_surat = upper(#{tgl_surat:DATE}), </if>
            <if test="mrc_pp != null">mrc_pp = upper(#{mrc_pp:INTEGER}), </if>
            <if test="lsbp_va != null">lsbp_va = upper(#{lsbp_va:VARCHAR}) </if>
        </trim> 
        WHERE REG_SPAJ = rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
    </update>   
    
    
    <insert id="insertMstRekClient" parameterType="com.app.model.gadget.prod.Rekening_client">
        INSERT INTO EKA.MST_REK_CLIENT (
            MRC_KURS, MRC_KOTA,
            <if test="tgl_surat != null">TGL_SURAT, </if>
            LUS_ID, TGL_CHANGE, MRC_KUASA,
            <if test="mrc_jn_nasabah != null">MRC_JN_NASABAH, </if>
            REG_SPAJ, LSBP_ID,
            <if test="lsbp_va != null">LSBP_VA, </if>
            MRC_CABANG, MRC_NAMA, MRC_NO_AC, MRC_JENIS, MRC_PP
        ) VALUES (
            upper(#{mrc_kurs:VARCHAR}), upper(#{mrc_kota:VARCHAR}),
            <if test="tgl_surat != null">(#{tgl_surat:DATE}), </if>
            (#{lus_id:INTEGER}), SYSDATE, (#{mrc_kuasa:INTEGER}),
            <if test="mrc_jn_nasabah != null">(#{mrc_jn_nasabah:INTEGER}), </if>
            upper(#{reg_spaj:VARCHAR}), (#{lsbp_id:VARCHAR}),
            <if test="lsbp_va != null">(#{lsbp_va:VARCHAR}), </if>
            upper(#{mrc_cabang:VARCHAR}), upper(#{mrc_nama:VARCHAR}), upper(#{mrc_no_ac:VARCHAR}), (#{mrc_jenis:INTEGER}), (#{mrc_pp:INTEGER})
        )                   
    </insert>

    <insert id="insertMstRekClientHist" parameterType="com.app.model.gadget.prod.Rekening_client">
        INSERT INTO "EKA"."MST_REK_HIST"
            (REG_SPAJ,TGL,LUS_ID
            <if test="notes != null">,NOTES </if>)
        VALUES
            ((#{reg_spaj:VARCHAR})  ,SYSDATE,(#{lus_id:INTEGER}) 
            <if test="notes != null">,upper(#{notes:VARCHAR})</if>)
    </insert>
            
    <insert id="insertMstAccountRecur" parameterType="com.app.model.gadget.prod.Account_recur">
        INSERT INTO EKA.MST_ACCOUNT_RECUR
                (REG_SPAJ, MAR_NUMBER, LBN_ID,
                 MAR_JENIS, MAR_ACC_NO, MAR_HOLDER,
                 MAR_EXPIRED, MAR_ACTIVE,MAR_TGL , LUS_ID , FLAG_JN_TABUNGAN, FLAG_AUTODEBET_NB, FLAG_SET_AUTO, TGL_DEBET)
        VALUES
                (upper(#{reg_spaj:VARCHAR})  , 1, (#{lbn_id:VARCHAR}),
                 (#{mar_jenis:INTEGER}), upper(#{mar_acc_no:VARCHAR}), upper(#{mar_holder:VARCHAR}),
                (#{mar_expired:DATE}), 1,SYSDATE ,(#{lus_id:INTEGER}), (#{flag_jn_tabungan:INTEGER}), (#{flag_autodebet_nb:INTEGER}),(#{flag_set_auto:INTEGER}),(#{tgl_debet:DATE}))    
    </insert>   
        
    <insert id="insertMstPositionSpaj" parameterType="java.util.HashMap">
        INSERT INTO eka.mst_position_spaj (reg_spaj, msps_date, lspd_id, lssp_id, lssa_id, lus_id, msps_desc)
           SELECT a.reg_spaj, sysdate + (eka.rownum_seq.nextval / (24*60*60)), a.lspd_id, lssp_id, lssa_id, #{lus_id:VARCHAR}, #{msps_desc:VARCHAR}
             FROM eka.mst_policy a, eka.mst_insured b
            WHERE a.reg_spaj = RPAD (REPLACE (#{reg_spaj:VARCHAR}, '.'), 11, ' ')
              AND a.reg_spaj = b.reg_spaj
              AND ROWNUM = 1
    </insert>
    
    <update id="updateMstInsuredTglAdmin" parameterType="java.util.HashMap">
        UPDATE eka.mst_insured 
        <choose>
            <when test="show ==0">
                SET mste_tgl_admin=#{tanggal:DATE}
            </when> 
            <when test="show ==1">
                SET mste_tgl_kirim_polis=#{tgl:DATE}
            </when> 
            <when test="show ==2">
                SET mste_tgl_spaj_doc=#{tgl:DATE}
            </when> 
            <when test="show ==3">
                SET mste_tgl_terima_admedika=#{tgl:DATE}
            </when> 
            <when test="show ==4">
                SET mste_tgl_terima_admin=#{tgl:DATE}
            </when> 
        </choose>   
            WHERE reg_spaj=#{spaj:VARCHAR} AND mste_insured_no=#{insuredNo:INTEGER}                 
    </update>

    <insert id="insertMst_position_no_spaj_pb" parameterType="java.util.HashMap">
            INSERT INTO eka.mst_position_spaj
                    (reg_spaj, msps_date, lspd_id, lssp_id, lus_id,
                     msps_desc
                    )
             VALUES (replace(#{strTmpSPAJ:VARCHAR},'.'), ${tgl}, #{lspd:INTEGER}, #{lssp:INTEGER}, #{lus_id:VARCHAR},
                     #{desc:VARCHAR}
                    )
    </insert>   
        
    <insert id="insertMstPositionSpajRedFlag" parameterType="java.util.HashMap">
        INSERT INTO eka.mst_position_spaj (reg_spaj, msps_date, lspd_id, lssp_id, lssa_id, lus_id, msps_desc,jenis)
           SELECT a.reg_spaj, sysdate + (eka.rownum_seq.nextval / (24*60*60)), a.lspd_id, lssp_id, lssa_id, #{lus_id:VARCHAR}, #{msps_desc:VARCHAR},#{jenis:VARCHAR}
             FROM eka.mst_policy a, eka.mst_insured b
            WHERE a.reg_spaj = RPAD (REPLACE (#{reg_spaj:VARCHAR, '.'), 11, ' ')
              AND a.reg_spaj = b.reg_spaj
              AND ROWNUM = 1
    </insert>
        
    <insert id="insertMst_sts_client" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_STS_CLIENT
            (MCL_ID,LJC_ID,MSC_TGL_STS,MSC_ACTIVE)
        VALUES
            (#{strInsClientID:VARCHAR},1,SYSDATE,1)
    </insert>   
    
    <insert id="inserMst_product_insured45" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_PRODUCT_INSURED
            (REG_SPAJ, MSTE_INSURED_NO, LSBS_ID,
            LSDBS_NUMBER, LKU_ID, MSPR_BEG_DATE,
             MSPR_END_DATE, MSPR_TSI, MSPR_TSI_PA_A,
             MSPR_TSI_PA_B, MSPR_TSI_PA_C, MSPR_TSI_PA_D,
             MSPR_TSI_PA_M, MSPR_CLASS, MSPR_UNIT,
             MSPR_RATE, MSPR_PERSEN, MSPR_PREMIUM,
             MSPR_DISCOUNT, MSPR_REF_NO, MSPR_ACTIVE,
             MSPR_EXTRA, MSPR_INS_PERIOD, MSPR_BUNGA_KPR,
             MSPR_INS_BULAN,MSPR_TT)
        VALUES
            (#{strTmpSPAJ:VARCHAR}, 1, #{v_intBaseBusinessId:INTEGER},
             #{v_intBaseBusinessNo:INTEGER}, #{v_strKurs:VARCHAR}, #{v_strBeginDate:DATE},
             #{v_strEndDate:DATE}, #{v_curUP:DOUBLE},#{v_curUP:DOUBLE},
             #{v_curUP:DOUBLE}, 0, #{v_curUP:DOUBLE},
             0, #{intClass:INTEGER}, 0,
             #{v_intBaseRate:DOUBLE}, 0, #{v_curBasePremium:DOUBLE},
             #{mspr_discount:DOUBLE}, NULL, 1,
             0, #{v_intInsPeriod:INTEGER}, NULL,
             NULL,0)    
    </insert>       
    
    <insert id="insertMst_product_insuredPA" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_PRODUCT_INSURED
                (REG_SPAJ, MSTE_INSURED_NO, LSBS_ID,
                LSDBS_NUMBER, LKU_ID, MSPR_BEG_DATE,
                MSPR_END_DATE, MSPR_TSI, MSPR_TSI_PA_A,
                MSPR_TSI_PA_B, MSPR_TSI_PA_C, MSPR_TSI_PA_D,
                MSPR_TSI_PA_M, MSPR_CLASS, MSPR_UNIT,
                MSPR_RATE, MSPR_PERSEN, MSPR_PREMIUM,
                MSPR_DISCOUNT, MSPR_REF_NO, MSPR_ACTIVE,
                MSPR_EXTRA, MSPR_INS_PERIOD, MSPR_BUNGA_KPR,
                MSPR_INS_BULAN,MSPR_TT)
            VALUES
                (#{strTmpSPAJ:VARCHAR}, 1, #{v_intBaseBusinessId:INTEGER},
                 #{v_intBaseBusinessNo:INTEGER}, #{v_strKurs:VARCHAR}, #{v_strBeginDate:DATE},
                #{v_strEndDate:DATE}, #{v_curUP:DOUBLE}, #{v_curUP_A:DOUBLE},
                #{v_curUP_B:DOUBLE}, 0, #{v_curUP_D:DOUBLE},
                0, #{intClass:INTEGER}, 0,
                #{v_intBaseRate:DOUBLE}, 0, #{v_curBasePremium:DOUBLE},
                #{mspr_discount:DOUBLE}, NULL, 1,
                0, #{v_intInsPeriod:INTEGER}, NULL,
                NULL,0) 
    </insert>
    
    <insert id="inserMst_product_insured1" parameterType="java.util.HashMap">
                    INSERT INTO EKA.MST_PRODUCT_INSURED
                        (REG_SPAJ, MSTE_INSURED_NO, LSBS_ID,
                         LSDBS_NUMBER, LKU_ID, MSPR_BEG_DATE,
                         MSPR_END_DATE, MSPR_TSI, MSPR_TSI_PA_A,
                         MSPR_TSI_PA_B, MSPR_TSI_PA_C, MSPR_TSI_PA_D,
                         MSPR_TSI_PA_M, MSPR_CLASS, MSPR_UNIT,
                         MSPR_RATE, MSPR_PERSEN, MSPR_PREMIUM,
                         MSPR_DISCOUNT, MSPR_REF_NO, MSPR_ACTIVE,
                         MSPR_EXTRA, MSPR_INS_PERIOD, MSPR_BUNGA_KPR,
                         MSPR_INS_BULAN
                         <if test="ldt_endpay != null">,MSPR_END_PAY</if>
                         ,MSPR_TT)
                    VALUES
                        (#{strTmpSPAJ:VARCHAR}, 1, #{v_intBaseBusinessId:INTEGER},
                         #{v_intBaseBusinessNo:INTEGER}, #{v_strKurs:VARCHAR}, #{v_strBeginDate:DATE},
                         #{v_strEndDate:DATE}, #{v_curUP:DOUBLE}, NULL,
                         NULL, NULL, NULL,
                         NULL, NULL, NULL,
                         #{v_intBaseRate:DOUBLE}, 0, #{v_curBasePremium:DOUBLE},
                         #{mspr_discount:DOUBLE}, NULL, 1,
                         NULL, #{v_intInsPeriod:INTEGER}, NULL,
                         NULL 
                          <if test="ldt_endpay != null">,#{ldt_endpay:DATE}</if>
                         ,0)
    </insert>   
    
    <insert id="insertMst_product_insured_rider" parameterType="java.util.HashMap">
        INSERT INTO EKA.MST_PRODUCT_INSURED
                    (REG_SPAJ, MSTE_INSURED_NO, LSBS_ID,
                     LSDBS_NUMBER, LKU_ID, MSPR_BEG_DATE,
                     MSPR_END_DATE, MSPR_TSI
                     <if test="intPAA != null">,MSPR_TSI_PA_A </if>
                     <if test="intPAB != null">,MSPR_TSI_PA_B </if>
                     <if test="intPAC != null">,MSPR_TSI_PA_C </if>
                     <if test="intPAD != null">,MSPR_TSI_PA_D </if>
                     <if test="intPAMotor != null">,MSPR_TSI_PA_M </if>                   
                     ,MSPR_CLASS, MSPR_UNIT,
                     MSPR_RATE, MSPR_PERSEN, MSPR_PREMIUM,
                     MSPR_DISCOUNT, MSPR_REF_NO, MSPR_ACTIVE,
                     MSPR_EXTRA, MSPR_INS_PERIOD, MSPR_BUNGA_KPR,
                     MSPR_INS_BULAN,MSPR_END_PAY,MSPR_TT,
                     MSPR_PU_PTB,FLAG_UP_SC)
                VALUES
                    (#{strTmpSPAJ:VARCHAR}, 1, #{v_intBaseBusinessId:INTEGER},
                     #{v_intBaseBusinessNo:INTEGER}, #{v_strKurs:VARCHAR}, #{v_strBeginDate:DATE},
                    #{v_strEndDate:DATE}, #{v_curUP:DOUBLE}                     
                     <if test="intPAA != null">,#{intPAA:DOUBLE} </if>
                     <if test="intPAB != null">,#{intPAB:DOUBLE} </if>
                     <if test="intPAC != null">,#{intPAC:DOUBLE} </if>
                     <if test="intPAD != null">,#{intPAD:DOUBLE} </if>
                     <if test="intPAMotor != null">,#{intPAMotor:DOUBLE} </if>      
                     ,#{intClass:INTEGER}, #{v_intUnit:INTEGER},
                     #{v_intBaseRate:DOUBLE}, #{v_percent:INTEGER}, #{v_curBasePremium:DOUBLE},
                     0, NULL, 1,
                     #{mspr_extra:DOUBLE}, #{v_intInsPeriod:INTEGER}, NULL,
                     NULL,#{ldt_endpay:DATE},#{ins_rider:INTEGER},
                     #{v_puptb:INTEGER},#{flag_up_sc:INTEGER})
    </insert>
    
    <insert id="insertmst_deposit" parameterType="com.app.model.gadget.prod.DetailPembayaran">
        INSERT INTO EKA.MST_DEPOSIT_PREMIUM
            (REG_SPAJ, MSDP_NUMBER, MSDP_JTP, LSJB_ID
            <if test="client_bank != null">, CLIENT_BANK </if>
            , MSDP_NO_REK, MSDP_PAY_DATE
            <if test="tgl_jatuh_tempo != null">, MSDP_DUE_DATE </if>
            , MSDP_DATE_BOOK, LKU_ID, MSDP_PAYMENT, MSDP_SELISIH_KURS, MSDP_INPUT_DATE   
            <if test="ref_polis_no != null">, MSDP_OLD_POLICY </if>
            , MSDP_DESC, LUS_ID, MSDP_ACTIVE, LSREK_ID, MSDP_FLAG, NO_KTTP, MSDP_NO_PRE
            <if test="msdp_flag_topup != null">, MSDP_FLAG_TOPUP </if>
            <if test="msdp_flag_merchant != null">, MSDP_FLAG_MERCHANT </if>
            )
        VALUES
            (#{reg_spaj:VARCHAR}, #{ke:INTEGER}, #{jenis_ttp:INTEGER}, #{cara_bayar:INTEGER}
            <if test="client_bank != null">, #{client_bank:VARCHAR} </if>
            , #{no_rek:VARCHAR}, #{tgl_bayar:DATE}
            <if test="tgl_jatuh_tempo != null">,  to_date(#{tgl_jatuh_tempo:VARCHAR},'DD/MM/YYYY') </if>
            , #{tgl_rk:DATE}, #{kurs:VARCHAR}, #{jml_bayar:DOUBLE}, #{nilai_kurs:DOUBLE}, #{tgl_skrg:DATE}
            <if test="ref_polis_no != null">,  #{ref_polis_no:VARCHAR} </if>
            , #{keterangan:VARCHAR}, #{lus_id:VARCHAR}, #{aktif:INTEGER}, #{bank:INTEGER}, #{status:VARCHAR}, #{no_kttp:VARCHAR}, #{no_pre:VARCHAR}
            <if test="msdp_flag_topup != null">,  #{msdp_flag_topup:INTEGER} </if>
            <if test="msdp_flag_merchant != null">,  #{msdp_flag_merchant:INTEGER} </if>
            )  
    </insert>
    
    <insert id="insertMstEmp" parameterType="com.app.model.gadget.prod.Employee">
              INSERT INTO EKA.MST_EMP
              (REG_SPAJ,NO_URUT,NIK,NAMA,CABANG,DEPT,PLAN,POTONGAN,TGL_PROSES,STATUS,KETERANGAN)  
              VALUES  
              ( upper(#{reg_spaj:VARCHAR}) ,(#{no_urut:INTEGER}),upper(#{nik:VARCHAR}) , upper(#{nama:VARCHAR}) ,upper(#{cabang:VARCHAR}) ,upper(#{dept:VARCHAR}), upper(#{plan:VARCHAR}),(#{potongan:DOUBLE}) ,(#{tgl_proses:DATE}) ,(#{status:INTEGER}) ,upper(#{keterangan:VARCHAR}))  
    </insert>           

        <update id="update_mst_ulink" parameterType="com.app.model.gadget.prod.InvestasiUtama">
            UPDATE EKA.MST_ULINK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
            SET                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                LT_ID = (#{lt_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                MU_AKTIF = (#{mu_aktif:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                MU_BULAN_SURAT = (#{mu_bulan_surat:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                MU_FLAG_PRINT = (#{mu_flag_print:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                MU_JLH_PREMI = (#{mu_jlh_premi:DOUBLE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                MU_JLH_TU = (#{mu_jlh_tu:DOUBLE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                MU_JLH_UNIT = (#{mu_jlh_unit:DOUBLE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                MU_LAST_SWITCH = (#{mu_last_switch:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                MU_LAST_WDRAW = (#{mu_last_wdraw:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                MU_LSPD_ID = (#{mu_lspd_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                MU_LUS_ID = (#{mu_lus_id:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                MU_PERIODIC_TU = (#{mu_periodic_tu:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                MU_PREMI_KE = (#{mu_ke:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                MU_SWITCH_CNT = (#{mu_switch_cnt:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                MU_TAHUN_KE = (#{mu_tahun_ke:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                MU_TGL_INPUT = (#{mu_tgl_input:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                MU_TGL_NAB = (#{mu_tgl_nab:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                MU_TGL_SURAT = (#{mu_tgl_surat:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                MU_TGL_TRANS = (#{mu_tgl_trans:DATE}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                MU_WDRAW_CNT = (#{mu_wdraw_cnt:INTEGER}),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                NO_REGISTER = upper(#{no_register:VARCHAR})                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
            WHERE REG_SPAJ = rpad(replace(#{reg_spaj:VARCHAR} ,'.'),11,' ')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
            AND MU_KE = #{mu_ke:INTEGER} 
    </update>   
    
    <insert id="insert_mst_ulink" parameterType="com.app.model.gadget.prod.InvestasiUtama">
                INSERT INTO EKA.MST_ULINK
                    (REG_SPAJ,MU_KE,MU_TGL_NAB,MU_JLH_PREMI,MU_TGL_SURAT,MU_BULAN_SURAT,
                    MU_PERIODIC_TU,MU_JLH_TU,MU_SWITCH_CNT,MU_LAST_SWITCH,MU_WDRAW_CNT,
                    MU_LAST_WDRAW,MU_LSPD_ID,MU_TGL_INPUT,MU_AKTIF,LT_ID,MU_TGL_TRANS,
                    NO_REGISTER,MU_LUS_ID,MU_TAHUN_KE,MU_PREMI_KE,MU_FLAG_PRINT,MU_JLH_UNIT)
                VALUES
                    ( upper(#{reg_spaj:VARCHAR}) ,(#{mu_ke:INTEGER}) ,NULL,(#{mu_jlh_premi:DOUBLE}) ,  (#{mu_tgl_surat:DATE})  ,(#{mu_bulan_surat:INTEGER}) ,
                    (#{mu_periodic_tu:INTEGER}) , (#{mu_jlh_tu:DOUBLE}) ,0,NULL,0,
                    NULL,1,SYSDATE,1,(#{lt_id:INTEGER}) ,(#{mu_tgl_trans:DATE}) ,
                    NULL,(#{mu_lus_id:INTEGER}) ,1,(#{mu_premi_ke:INTEGER}),0,0)
    </insert>
    
    <insert id="insertFixed" parameterType="java.util.HashMap">
                INSERT INTO EKA.MST_DET_ULINK
                    (REG_SPAJ,MU_KE,LJI_ID,MDU_PERSEN,MDU_SALDO_UNIT,MDU_JUMLAH,
                    MDU_PERSEN_TU,MDU_LAST_TRANS,MDU_AKTIF,MDU_FLAG_MIN,MDU_UNIT)
                VALUES
                    (#{strTmpSPAJ:VARCHAR},#{mu_ke:INTEGER},#{nilai:VARCHAR},#{v_fixedvalue:INTEGER},0,#{jmlhfixed:DOUBLE},
                    #{v_persen_tu:INTEGER},#{v_last_trans:DATE},1,0,0)
    </insert>
    
    <insert id="insertMst_biaya_ulink" parameterType="java.util.HashMap">
            INSERT INTO "EKA"."MST_BIAYA_ULINK"
                (REG_SPAJ,MU_KE,LJB_ID,MBU_JUMLAH,MBU_PERSEN,MBU_END_PAY)  
            VALUES
                (#{strTmpSPAJ:VARCHAR},#{mu_ke:INTEGER},#{ljb_id:INTEGER},#{mbu_jumlah:DOUBLE},#{mbu_persen:DOUBLE},#{ldt_endpay:DATE})
    </insert>
    
    <insert id="insertMst_benefeciary" parameterType="com.app.model.gadget.prod.Benefeciary">
                        INSERT INTO EKA.MST_BENEFECIARY
                        (REG_SPAJ, MSTE_INSURED_NO, MSAW_NUMBER,
                         MSAW_FIRST, 
                         MSAW_BIRTH, LSRE_ID, MSAW_PERSEN, MSAW_SEX,LSNE_ID,MSAW_KET)
                    VALUES
                        (upper(#{reg_spaj:VARCHAR}) , 1, (#{msaw_number:INTEGER}),
                         upper(#{msaw_first:VARCHAR}) ,
                         (#{msaw_birth:DATE}), (#{lsre_id:INTEGER}) , (#{msaw_persen:DOUBLE}), (#{msaw_sex:INTEGER}), (#{lsne_id:INTEGER}),(#{msaw_ket:VARCHAR}))
    </insert>   
    
    <insert id="insertMst_rencana_penarikan" parameterType="com.app.model.gadget.prod.RencanaPenarikan">
        insert into eka.mst_rencana_penarikan
            (reg_spaj, jenis, tgl_penarikan, jumlah, keterangan, proses, lus_id, tgl_input)
        values
            (#{reg_spaj:VARCHAR}, #{jenis:INTEGER}, #{tgl_penarikan:DATE}, #{jumlah:DOUBLE}, upper(#{keterangan:VARCHAR}), #{proses:INTEGER}, #{lus_id:INTEGER}, SYSDATE)
    </insert>   
    
    <insert id="insert_mst_peserta_plus_mix" parameterType="com.app.model.gadget.prod.PesertaPlus_mix">
        INSERT INTO EKA.MST_PESERTA
            (REG_SPAJ, NO_URUT, LSRE_ID, NAMA, TGL_LAHIR, 
            KELAMIN, UMUR, PREMI,LSBS_ID, LSDBS_NUMBER,DISCOUNT,NO_REG,LSPC_NO, 
            FLAG_VAL_SEND, FLAG_ADMEDIKA, NEXT_SEND, FLAG_JENIS_PESERTA,MSPO_PROVIDER,HEIGHT,WEIGHT,LSNE_ID,MKL_KERJA)
        VALUES
            (upper(#{reg_spaj:VARCHAR}) ,#{no_urut:INTEGER}, #{lsre_id:INTEGER}, upper(#{nama:VARCHAR}), #{tgl_lahir:DATE}, 
            #{kelamin:INTEGER},#{umur:INTEGER},#{premi:DOUBLE},#{lsbs_id:INTEGER},#{lsdbs_number:INTEGER},#{discount:DOUBLE}, #{no_reg:VARCHAR}, #{lspc_no:INTEGER}, #{flag_val_send:INTEGER}, 
            #{flag_admedika:INTEGER}, #{next_send:DATE}, #{flag_jenis_peserta:INTEGER},#{mspo_provider:INTEGER},#{tinggi:INTEGER},#{berat:INTEGER},#{lsne:VARCHAR},#{kerja:VARCHAR})
    </insert>
    
    <update id="updateMstSpajTemp" parameterType="java.util.HashMap">
        UPDATE eka.mst_spaj_temp
           SET reg_Spaj=rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
         WHERE no_temp=#{no_temp:VARCHAR}
    </update>
    
    <update id="updateMstProductTemp" parameterType="java.util.HashMap">
        UPDATE eka.mst_product_temp
           SET reg_Spaj=rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
         WHERE no_temp=#{no_temp:VARCHAR}
    </update>
    
    <update id="updateMstAddressBillingTemp" parameterType="java.util.HashMap">
        UPDATE eka.mst_address_billing_temp
            SET reg_Spaj=rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
         WHERE no_temp=#{no_temp:VARCHAR}
    </update>
    
    <update id="updateMstPesertaTemp" parameterType="java.util.HashMap">
        UPDATE eka.mst_peserta_temp
           SET reg_Spaj=rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
         WHERE no_temp=#{no_temp:VARCHAR}
    </update>
    
    <insert id="insertMedQuestFromTemp" parameterType="java.util.HashMap">
            insert into eka.MST_ADDITIONAL_DESC_INSURED(reg_spaj,mste_insured_no,msadm_berat,msadm_tinggi,
                                     msadm_medis,msadm_medis_desc,msadm_sehat,
                                     msadm_sehat_desc,msadm_penyakit,msadm_penyakit_desc,
                                     msadm_em_life,msadm_pregnant,msadm_pregnant_time  ,msadm_clear_case                                  
                                     )   
             select #{reg_spaj:VARCHAR},mste_insured_no,msadm_berat,msadm_tinggi,
                     msadm_medis,msadm_medis_desc,msadm_sehat,
                     msadm_sehat_desc,msadm_penyakit,msadm_penyakit_desc,
                     msadm_em_life,msadm_pregnant,msadm_pregnant_time ,msadm_clear_case
               from eka.MST_ADDITIONAL_DESC_TEMP
              where no_temp = #{no_temp:VARCHAR}               
    </insert>   
    
    <insert id="insertReffBiiFromTemp" parameterType="java.util.HashMap">
        insert into eka.mst_reff_bii (reg_spaj, level_id, lcb_no, lrb_id, no_urut, tgl_input, reff_id, jn_nasabah,
            lcb_penutup, lcb_freeze, lus_id, lcb_reff, lcb_reff_freeze)
        select #{reg_spaj:VARCHAR}, level_id, lcb_no, lrb_id, no_urut, tgl_input, reff_id, jn_nasabah, lcb_penutup, lcb_freeze, lus_id,
            lcb_reff, lcb_reff_freeze
        from eka.mst_reff_bii_temp
        where trim(no_temp) = trim(#{no_temp:VARCHAR})
    </insert>
    
    <insert id="insertQuestionaireFromTemp" parameterType="java.util.HashMap">
        insert into eka.mst_question_answer
            (key_type, key_id, question_type_id, QUESTION_ID, QUESTION_VALID_DATE,
            OPTION_TYPE, OPTION_GROUP, OPTION_ORDER, ANSWER_ORDER, ANSWER,INPUT_DATE, LUS_ID)
        select a.key_type,#{reg_spaj:VARCHAR},a.question_type_id,a.QUESTION_ID,b.question_valid_date,
            b.OPTION_TYPE,a.OPTION_GROUP,a.OPTION_ORDER,a.ANSWER_ORDER,a.ANSWER,a.INPUT_DATE,a.LUS_ID
        from eka.mst_question_answer_temp a,eka.lst_question_label b
        where a.question_type_id = b.question_type_id
            and a.question_id = b.question_id
            and a.option_group = b.option_group
            and a.option_order = b.option_order
            and no_temp = #{no_temp:VARCHAR}               
    </insert>
    
    <update id="updateMstDetVa" parameterType="java.util.HashMap">
        UPDATE eka.mst_det_va
           SET spaj=rpad(replace(#{spaj:VARCHAR},'.'),11,' '),
              input_date = sysdate ,
              user_input =#{lus_id:INTEGER}
         WHERE no_va=#{no_va:VARCHAR}
    </update>
    
    <update id="updateMstpositionSpajTgl" parameterType="java.util.HashMap">
        UPDATE eka.mst_position_spaj 
        SET    msps_date=sysdate,
                    lus_id=#{lus_id:INTEGER},
                    msps_desc=#{keterangan:VARCHAR}
        WHERE reg_spaj=#{spaj:VARCHAR} AND msps_desc like '%${msps_desc}%'
    </update>
        
    <update id="updateProsesKyc" parameterType="java.util.HashMap" >
        UPDATE eka.mst_insured
            SET mste_flag_uw = #{mste_flag_uw:INTEGER},
                mste_kyc_date= trunc(SYSDATE),
                mste_kyc_lus_id =#{lusId:VARCHAR}
        where   reg_spaj=rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ') and 
                mste_insured_no=#{mste_insured_no:INTEGER}
    </update>
    
    
    <update id="updateMstChecklist" parameterType="com.app.model.gadget.prod.Checklist">
        UPDATE eka.mst_checklist
        <trim prefix="SET" suffixOverrides=",">    
            <if test="flag_adm !=null">
                flag_adm = #{flag_adm:INTEGER},
            </if>
            <if test="flag_filling !=null">
                flag_filling = #{flag_filling:INTEGER},
            </if>
            <if test="flag_print !=null">           
                flag_print = #{flag_print:INTEGER},
            </if>
            <if test="flag_bancass !=null"> 
                flag_bancass = #{flag_bancass:INTEGER},
            </if>
            <if test="flag_uw !=null">
                flag_uw = #{flag_uw:INTEGER},
            </if>
            <if test="lc_id !=null">
                lc_id = #{lc_id:INTEGER},
            </if>
            <if test="lus_id_adm !=null">
                lus_id_adm = #{lus_id_adm:INTEGER},
            </if>
            <if test="lus_id_filling !=null">
                lus_id_filling = #{lus_id_filling:INTEGER},
            </if>
            <if test="lus_id_print !=null">
                lus_id_print = #{lus_id_print:INTEGER},
            </if>
            <if test="lus_id_bancass !=null">
                lus_id_bancass = #{lus_id_bancass:INTEGER},
            </if>
            <if test="lus_id_uw !=null">
                lus_id_uw = #{lus_id_uw:INTEGER},
            </if>
            <if test="mc_desc !=null">
                mc_desc = upper(#{mc_desc:VARCHAR}),
            </if>
            <if test="mc_no !=null">
                mc_no = #{mc_no:INTEGER},
            </if>
            <if test="reg_spaj !=null">
                reg_spaj = upper(#{reg_spaj:VARCHAR}),
            </if>
            <if test="tgl_adm !=null">
                tgl_adm = #{tgl_adm:DATE},          
            </if>
            <if test="tgl_filling !=null">
                tgl_filling = #{tgl_filling:DATE},  
            </if>
            <if test="tgl_print !=null">
                tgl_print = #{tgl_print:DATE},
            </if>
            <if test="tgl_bancass !=null">
                tgl_bancass = #{tgl_bancass:DATE},
            </if>
            <if test="tgl_uw !=null">
                tgl_uw = #{tgl_uw:DATE}
            </if>
        </trim> 
        WHERE REG_SPAJ = #{reg_spaj:VARCHAR} AND LC_ID = #{lc_id:INTEGER}
     </update>  
     
     
     <insert id="insertMstChecklist" parameterType="com.app.model.gadget.prod.Checklist">
        INSERT INTO eka.mst_checklist
                    (reg_spaj, lc_id, mc_no,
                     mc_desc, lus_id_adm, lus_id_bancass,
                     lus_id_uw, lus_id_print,
                     lus_id_filling, tgl_adm, tgl_bancass,
                     tgl_uw, tgl_print,
                     tgl_filling, flag_adm, flag_bancass, flag_uw,
                     flag_print, flag_filling)
             VALUES (UPPER (#{reg_spaj:VARCHAR}), #{lc_id:INTEGER}, 
                        (SELECT NVL (MAX (mc_no), 0) + 1 FROM eka.mst_checklist WHERE reg_spaj = #{reg_spaj:VARCHAR}),
                     UPPER (#{mc_desc:VARCHAR}), #{lus_id_adm:INTEGER},
                     #{lus_id_bancass:INTEGER}, #{lus_id_uw:INTEGER}, #{lus_id_print:INTEGER},
                     #{lus_id_filling:INTEGER}, #{tgl_adm:DATE},
                     #{tgl_bancass:DATE}, #{tgl_uw:DATE}, #{tgl_print:DATE},
                     #{tgl_filling:DATE}, #{flag_adm:INTEGER}, #{flag_bancass:INTEGER}, #{flag_uw:INTEGER},
                     #{flag_print:INTEGER}, #{flag_filling:INTEGER})    
    </insert>
    
    <update id="updateFlagSPH" parameterType="java.util.HashMap">
        update eka.mst_policy 
        set mspo_flag_sph = #{mspo_flag_sph:INTEGER}
        where reg_spaj = rpad(replace(#{spaj:VARCHAR} ,'.'),11,' ')
    </update>
    
    <update id="updateFlagAprove" parameterType="java.util.HashMap">
        UPDATE eka.mst_insured                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
        SET ${kolom} = #{flag_approve:INTEGER}
        WHERE reg_spaj = rpad(replace(#{reg_spaj:VARCHAR},'.'),11,' ')
    </update>
            
    <update id="updateMstPolicyPosition" parameterType="java.util.HashMap">
        UPDATE  EKA.MST_POLICY
             SET  EKA.MST_POLICY.LSPD_ID = #{lspdId:INTEGER} 
             WHERE  EKA.MST_POLICY.LSTB_ID = #{lstbId:INTEGER} and
                    EKA.MST_POLICY.REG_SPAJ= #{spaj:VARCHAR}
    </update>
    
    <update id="updatePositionMstInsured" parameterType="java.util.HashMap">
        UPDATE EKA.MST_INSURED                                                                                                                                                                                                                                                                                                                                                                             
        SET LSPD_ID = #{lspdId:INTEGER},                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            LSSA_ID = (#{lssaId:INTEGER})
            WHERE REG_SPAJ =  rpad(replace(#{spaj:VARCHAR},'.'),11,' ')                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
            AND MSTE_INSURED_NO = #{insuredNo:INTEGER}
    </update>
    
    <update id="updateLstMember" parameterType="java.lang.String">
        update eka.lst_member
        set flag_submit = 1
        where no_va = trim(#{value:VARCHAR})
    </update>
    
    
    <update id="updateKartuPas" parameterType="java.util.HashMap">
        UPDATE eka.mst_kartu_pas set
		flag_active = #{flag_active:INTEGER}
		<if test="tgl_active == 1">, tgl_active = sysdate</if>	
		<if test="tgl_active == 0">, tgl_active = null</if>	
		where no_kartu = trim(#{no_kartu:VARCHAR})  		 
    </update>
    
    	<!-- Update untuk month year sequence -->
	<update id="updateCounterMonthYear" parameterType="java.util.HashMap">
		UPDATE eka.mst_counter
		   SET msco_month_year = #{nilai,jdbcType=VARCHAR}
		 WHERE msco_number = #{aplikasi,jdbcType=INTEGER} AND lca_id = #{cabang,jdbcType=VARCHAR}
   	</update>

   	
   	<!--Update mst_policy-->
    <update id="commonupdateMstPolicy" parameterType="java.util.HashMap">
        UPDATE EKA.MST_POLICY   
               SET MSPO_POLICY_HOLDER = #{ls:VARCHAR}   
           WHERE EKA.MST_POLICY.REG_SPAJ = #{nospaj:VARCHAR} 
    </update>
    
    <!--Update mst_insured-->
    <update id="commonupdateMstInsured" parameterType="java.util.HashMap">
            UPDATE EKA.MST_INSURED   
                SET MSTE_INSURED = #{ls:VARCHAR}
           WHERE EKA.MST_INSURED.REG_SPAJ = #{nospaj:VARCHAR}
    </update>
    
    <update id="updateMstStsClient" parameterType="java.util.HashMap">
        UPDATE EKA.MST_STS_CLIENT
              SET MSC_TGL_STS = sysdate , MSC_ACTIVE = #{msc_active:INTEGER}
            WHERE ( EKA.MST_STS_CLIENT.MCL_ID = #{mcl_id:VARCHAR} ) AND  
                    ( EKA.MST_STS_CLIENT.LJC_ID = #{ljc_id:INTEGER} ) 
    </update>
    
    <update id="updateMReasTempMsteReas" parameterType="java.util.HashMap">
                UPDATE EKA.M_REAS_TEMP  
                    SET MSTE_REAS = #{mste_reas:INTEGER}
                 WHERE EKA.M_REAS_TEMP.REG_SPAJ = #{spaj:VARCHAR}
    </update>
    
    <!--Update mst_insured-->
    <update id="updateMstInsuredReasnBackup" parameterType="java.util.HashMap">
            UPDATE EKA.MST_INSURED  
                SET      MSTE_REAS = #{li_reas:INTEGER}
                         ,MSTE_BACKUP = #{li_backup:INTEGER}
                    <if test="lssaId != null">
                         ,LSSA_ID = #{lssaId:INTEGER}
                    </if>
                    <if test="medis != null">     
                         ,MSTE_MEDICAL = #{medis:INTEGER}
                    </if>     
                WHERE  ( EKA.MST_INSURED.REG_SPAJ = #{txtnospaj:VARCHAR}) AND  
                         ( EKA.MST_INSURED.MSTE_INSURED_NO = #{txtli_insured_no:INTEGER} )   
        
    </update>
    
    <!--Update m_reas_temp-->
    <update id="updateMReasTemp" parameterType="java.util.HashMap">
             UPDATE EKA.M_REAS_TEMP  
              SET SIMULTAN_CASH = #{sim_cash:NUMERIC},   
                    TSI_CASH = #{ldec_tsi_cash:NUMERIC},   
                    SAR_CASH = #{ldec_sar_cash:NUMERIC},   
                    RETENSI_CASH = #{ldec_rts_cash:NUMERIC},   
                    REAS_CASH = #{ldec_rea_cash:NUMERIC},
                    SIMULTAN_TPD = #{sim_tpd:NUMERIC},   
                    TSI_TPD = #{ldec_tsi_tpd:NUMERIC},   
                    SAR_TPD = #{ldec_sar_tpd:NUMERIC},   
                    RETENSI_TPD = #{ldec_rts_tpd:NUMERIC},   
                    REAS_TPD = #{ldec_rea_tpd:NUMERIC}
            WHERE EKA.M_REAS_TEMP.REG_SPAJ = #{txtnospaj:VARCHAR}
    </update>
    
    <update id="updateMstPolicyMspoNextBill" parameterType="java.util.HashMap">
        UPDATE  EKA.MST_POLICY
             SET  EKA.MST_POLICY.MSPO_NEXT_BILL = #{mspo_next_bill:DATE} 
             WHERE  EKA.MST_POLICY.LSTB_ID = #{lstb_id:INTEGER} and
                    EKA.MST_POLICY.REG_SPAJ= #{reg_spaj:VARCHAR}
    </update>
    
    <!--Update mst_cnt_polis-->
    <update id="updateMstCntPolis" parameterType="java.util.HashMap">
         UPDATE EKA.MST_CNT_POLIS  
              SET MSCNP_VALUE = #{ld_no:NUMERIC}  
              WHERE ( EKA.MST_CNT_POLIS.LCA_ID = #{as_cab:VARCHAR} ) AND  
                    ( EKA.MST_CNT_POLIS.LSBS_ID = #{as_bisnis:INTEGER} )   
              
    </update>
    
    <!--Update mst_policy nopolis-->
    <update id="updateMstPolicyNopolis" parameterType="java.util.HashMap">
        UPDATE EKA.MST_POLICY 
             SET MSPO_POLICY_NO =#{ls_nopol:VARCHAR},   
                    MSPO_POLICY_NO_FORMAT=#{ls_nopol_formated:VARCHAR}  
            WHERE EKA.MST_POLICY.REG_SPAJ = #{txtnospaj:VARCHAR} and  
                  EKA.MST_POLICY.LSTB_ID = 1
    </update>
    
    <!--Update mst_policy mspo preexisting-->
    <update id="updateMstPolicyMspoPreExisting" parameterType="java.util.HashMap">
        UPDATE EKA.MST_POLICY 
             SET MSPO_PREEXISTING=#{value:INTEGER}}
           WHERE ( EKA.MST_POLICY.REG_SPAJ = #{txtnospaj:VARCHAR} ) and  
                  ( ( EKA.MST_POLICY.LSPD_ID = #{lspdId:INTEGER} ) AND  
                  ( EKA.MST_POLICY.LSTB_ID = #{lstbId:INTEGER} ) )   
                    
              
    </update>
    
    <!--Update mst_insured_status-->
    <update id="updateMstInsuredStatus" parameterType="java.util.HashMap">
        UPDATE EKA.MST_INSURED  
            SET    LSSA_ID = #{li_aksep:INTEGER} 
            <if test="lusId != null and lusId != ''">,LUS_ID=#{lusId:VARCHAR}</if>
            <if test="flagTgl != null and flagTgl != ''">,MSTE_TGL_AKSEP=sysdate</if>
            <if test="li_aktif != null">,MSTE_ACTIVE = #{li_aktif:INTEGER} </if>
            WHERE  ( EKA.MST_INSURED.REG_SPAJ = #{txtnospaj:VARCHAR})AND  
                     ( EKA.MST_INSURED.MSTE_INSURED_NO = #{txtinsured_no:INTEGER})   
    </update>
    
    <update id="updateVirtualAccountBySpaj" parameterType="java.util.HashMap">
        UPDATE eka.mst_insured ins
           SET ins.mste_no_vacc =
                          #{no_virtual:VARCHAR}
                          || (SELECT decode(b.lsgb_id, 17, 0, 1) kode
                                FROM eka.mst_product_insured a, eka.lst_bisnis b
                               WHERE a.reg_spaj = ins.reg_spaj AND a.lsbs_id <![CDATA[<]]> 300 AND a.lsbs_id = b.lsbs_id) || ins.reg_spaj
         WHERE ins.reg_spaj = RPAD (REPLACE (#{reg_spaj:VARCHAR}, '.'), 11, ' ')
    </update>
    
    <update id="updateKartuPas2" parameterType="java.util.HashMap">
        UPDATE eka.mst_kartu_pas set reg_spaj = #{reg_spaj:VARCHAR}
        where no_kartu = trim(#{no_kartu:VARCHAR})                              
    </update>

    <update id="updatePas" parameterType="com.app.model.bsim.Pas">
        UPDATE eka.mst_pas_sms                                                
        <set>                                                       
            <if test="msp_kode_sts_sms != null">msp_kode_sts_sms = upper(#{msp_kode_sts_sms:VARCHAR}),</if>
            <if test="msp_desc_sts_sms != null">msp_desc_sts_sms = upper(#{msp_desc_sts_sms:VARCHAR}),</if>
            <if test="msp_mobile != null">msp_mobile = upper(#{msp_mobile:VARCHAR}),</if>
            <if test="msp_mobile2 != null">msp_mobile2 = upper(#{msp_mobile2:VARCHAR}),</if>
            <if test="msp_text != null">msp_text = upper(#{msp_text}),</if>
            <if test="msp_message_date != null">msp_message_date = #{msp_message_date:DATE},</if>
            <if test="msp_receive_date != null">msp_receive_date = #{msp_receive_date:DATE},</if>
            <if test="msp_rek_cabang != null">msp_rek_cabang = upper(#{msp_rek_cabang:VARCHAR}),</if>
            <if test="msp_rek_nama != null">msp_rek_nama = upper(#{msp_rek_nama:VARCHAR}),</if>
            <if test="msp_rek_nama_autodebet != null">msp_rek_nama_autodebet = upper(#{msp_rek_nama_autodebet:VARCHAR}),</if>
            <if test="msp_rek_kota != null">msp_rek_kota = upper(#{msp_rek_kota:VARCHAR}),</if>
            <if test="msp_full_name != null">msp_full_name = upper(#{msp_full_name:VARCHAR}),</if>
            <if test="msp_identity_no != null">msp_identity_no = upper(#{msp_identity_no:VARCHAR}),</if>
            <if test="msp_identity_no_tt != null">msp_identity_no_tt = upper(#{msp_identity_no_tt:VARCHAR}),</if>
            <if test="msp_date_of_birth != null">msp_date_of_birth = #{msp_date_of_birth:DATE},</if>
            <if test="msp_address_1 != null">msp_address_1 = upper(#{msp_address_1:VARCHAR}),</if>
            <if test="msp_address_2 != null">msp_address_2 = upper(#{msp_address_2:VARCHAR}),</if>
            <if test="msp_city != null">msp_city = upper(#{msp_city:VARCHAR}),</if>
            <if test="msp_postal_code != null">msp_postal_code = upper(#{msp_postal_code:VARCHAR}),</if>
            <if test="dist != null">dist = upper(#{dist:VARCHAR}),</if>
            <if test="pin != null">pin = upper(#{pin:VARCHAR}),</if>
            <if test="no_kartu != null">no_kartu = upper(#{no_kartu:VARCHAR}),</if>
            <if test="msp_fire_export_flag != null">msp_fire_export_flag = #{msp_fire_export_flag:INTEGER},</if>
            <if test="msp_fire_export_date != null">msp_fire_export_date = #{msp_fire_export_date:DATE},</if>
            <if test="lspd_id != null">lspd_id = #{lspd_id:INTEGER},</if>
            <if test="lssp_id != null">lssp_id = #{lssp_id:INTEGER},</if>
            <if test="lssa_id != null">lssa_id = #{lssa_id:INTEGER},</if>
            <if test="lscb_id != null">lscb_id = #{lscb_id:INTEGER},</if>
            <if test="lsbp_id != null">lsbp_id = #{lsbp_id:INTEGER},</if>
            <if test="lsbp_id_autodebet != null">lsbp_id_autodebet = #{lsbp_id_autodebet:INTEGER},</if>
            <if test="msp_flag_aksep != null">msp_flag_aksep = #{msp_flag_aksep:INTEGER},</if>
            <if test="msp_pas_phone_number != null">msp_pas_phone_number = #{msp_pas_phone_number:VARCHAR},</if>
            <if test="msp_pas_accept_date != null">msp_pas_accept_date = #{msp_pas_accept_date:DATE},</if>
            <if test="msp_pas_beg_date != null">msp_pas_beg_date = #{msp_pas_beg_date:DATE},</if>
            <if test="msp_pas_end_date != null">msp_pas_end_date = #{msp_pas_end_date:DATE},</if>
            <if test="msp_admin_date != null">msp_admin_date = #{msp_admin_date:DATE},</if>
            <if test="msp_fire_accept_date != null">msp_fire_accept_date = #{msp_fire_accept_date:DATE},</if>
            <if test="msp_fire_okupasi_else != null">msp_fire_okupasi_else = #{msp_fire_okupasi_else:VARCHAR},</if>
            <if test="msp_fire_ins_addr_envir_else != null">msp_fire_ins_addr_envir_else = #{msp_fire_ins_addr_envir_else:VARCHAR},</if>
            <if test="msp_fire_beg_date != null">msp_fire_beg_date = #{msp_fire_beg_date:DATE},</if>
            <if test="msp_fire_end_date != null">msp_fire_end_date = #{msp_fire_end_date:DATE},</if>
            <if test="msp_fire_policy_no != null">msp_fire_policy_no = upper(#{msp_fire_policy_no:VARCHAR}),</if>
            <if test="msp_fire_code_name != null">msp_fire_code_name = upper(#{msp_fire_code_name:VARCHAR}),</if>
            <if test="msp_fire_insured_city != null">msp_fire_insured_city = #{msp_fire_insured_city:VARCHAR},</if>
            <if test="msp_fire_insured_phone_number != null">msp_fire_insured_phone_number = upper(#{msp_fire_insured_phone_number:VARCHAR}),</if>
            <if test="msp_fire_name != null">msp_fire_name = upper(#{msp_fire_name:VARCHAR}),</if>
            <if test="msp_fire_id != null">msp_fire_id = upper(#{msp_fire_id:VARCHAR}),</if>
            <if test="msp_fire_identity != null">msp_fire_identity = upper(#{msp_fire_identity:VARCHAR}),</if>
            <if test="msp_fire_occupation != null">msp_fire_occupation = upper(#{msp_fire_occupation:VARCHAR}),</if>
            <if test="msp_fire_type_business != null">msp_fire_type_business = upper(#{msp_fire_type_business:VARCHAR}),</if>
            <if test="msp_fire_source_fund != null">msp_fire_source_fund = upper(#{msp_fire_source_fund:VARCHAR}),</if>
            <if test="msp_fire_address_1 != null">msp_fire_address_1 = upper(#{msp_fire_address_1:VARCHAR}),</if>
            <if test="msp_fire_addr_code != null">msp_fire_addr_code = upper(#{msp_fire_addr_code:VARCHAR}),</if>
            <if test="msp_fire_phone_number != null">msp_fire_phone_number = upper(#{msp_fire_phone_number:VARCHAR}),</if>
            <if test="msp_fire_email != null">msp_fire_email = upper(#{msp_fire_email:VARCHAR}),</if>
            <if test="msp_fire_okupasi != null">msp_fire_okupasi = upper(#{msp_fire_okupasi:VARCHAR}),</if>
            <if test="msp_fire_postal_code != null">msp_fire_postal_code = upper(#{msp_fire_postal_code:VARCHAR}),</if>
            <if test="msp_fire_mobile != null">msp_fire_mobile = upper(#{msp_fire_mobile:VARCHAR}),</if>
            <if test="msp_fire_fail_desc != null">msp_fire_fail_desc = upper(#{msp_fire_fail_desc:VARCHAR}),</if>
            <if test="msp_fire_insured_addr_code != null">msp_fire_insured_addr_code = upper(#{msp_fire_insured_addr_code:VARCHAR}),</if>
            <if test="msp_fire_insured_addr != null">msp_fire_insured_addr = upper(#{msp_fire_insured_addr:VARCHAR}),</if>
            <if test="msp_fire_insured_postal_code != null">msp_fire_insured_postal_code = upper(#{msp_fire_insured_postal_code:VARCHAR}),</if>
            <if test="msp_fire_insured_addr_no != null">msp_fire_insured_addr_no = upper(#{msp_fire_insured_addr_no:VARCHAR}),</if>
            <if test="msp_fire_insured_addr_envir != null">msp_fire_insured_addr_envir = #{msp_fire_insured_addr_envir:VARCHAR},</if>
            <if test="msp_fire_date_of_birth != null">msp_fire_date_of_birth = #{msp_fire_date_of_birth:DATE},</if>
            <if test="msp_fire_fail_date != null">msp_fire_fail_date = #{msp_fire_fail_date:DATE},</if>
            <if test="msp_no_rekening != null">msp_no_rekening = upper(#{msp_no_rekening:VARCHAR}),</if>
            <if test="msp_no_rekening_autodebet != null">msp_no_rekening_autodebet = upper(#{msp_no_rekening_autodebet:VARCHAR}),</if>
            <if test="msag_id != null">msag_id = upper(#{msag_id:VARCHAR}),</if>
            <if test="lrb_id != null">lrb_id = #{lrb_id:INTEGER},</if>
            msag_id_pp = #{msag_id_pp:VARCHAR},         
            <if test="kode_ao != null">kode_ao = upper(#{kode_ao:VARCHAR}),</if>
            <if test="pribadi != null">pribadi = #{pribadi:INTEGER},</if>
            <if test="msp_flag_cc != null">msp_flag_cc = upper(#{msp_flag_cc:VARCHAR}),</if>
            <if test="lus_id != null">lus_id = #{lus_id:INTEGER},</if>
            <if test="lus_id_uw_pas != null">lus_id_uw_pas = #{lus_id_uw_pas:INTEGER},</if>
            <if test="lus_id_uw_fire != null">lus_id_uw_fire = #{lus_id_uw_fire:INTEGER},</if>
            <if test="lus_id_uw_batal != null">lus_id_uw_batal = #{lus_id_uw_batal:INTEGER},</if>
            <if test="mspo_policy_no != null">mspo_policy_no = upper(#{mspo_policy_no:VARCHAR}),</if>
            <if test="reg_spaj != null">reg_spaj = upper(#{reg_spaj:VARCHAR}),</if>
            <if test="mspo_plan_provider != null">mspo_plan_provider = upper(#{mspo_plan_provider:VARCHAR}),</if>
            <if test="msp_pas_tmp_lhr_tt != null">msp_pas_tmp_lhr_tt = #{msp_pas_tmp_lhr_tt:VARCHAR},</if>
            <if test="msp_pas_dob_pp != null">msp_pas_dob_pp = #{msp_pas_dob_pp:DATE},</if>
            <if test="lsre_id != null">lsre_id = #{lsre_id:INTEGER},</if>
            <if test="produk != null">produk = #{produk:INTEGER},</if>
            <if test="msp_sex_pp != null">msp_sex_pp = #{msp_sex_pp:INTEGER},</if>
            <if test="msp_sex_tt != null">msp_sex_tt = #{msp_sex_tt:INTEGER},</if>
            <if test="msp_exist_bp != null">msp_exist_bp = #{msp_exist_bp:INTEGER},</if>
            <if test="msp_pas_nama_pp != null">msp_pas_nama_pp = upper(#{msp_pas_nama_pp:VARCHAR}),</if>
            <if test="msp_pas_email != null">msp_pas_email = upper(#{msp_pas_email:VARCHAR}),</if>
            <if test="msp_pas_tmp_lhr_pp != null">msp_pas_tmp_lhr_pp = upper(#{msp_pas_tmp_lhr_pp:VARCHAR}),</if>
            <if test="msp_tgl_debet != null">msp_tgl_debet = #{msp_tgl_debet:DATE},</if>
            <if test="msp_tgl_valid != null">msp_tgl_valid = #{msp_tgl_valid:DATE},</if>
            <if test="msp_ket_batal != null">msp_ket_batal = #{msp_ket_batal:DATE},</if>
            <if test="msp_tgl_batal != null">msp_tgl_batal = #{msp_tgl_batal:DATE},</if>
            <if test="msp_tgl_transfer != null">msp_tgl_transfer = #{msp_tgl_transfer:DATE},</if>
            <if test="msp_warga != null">msp_warga = #{msp_warga:INTEGER},</if>
            <if test="msp_warga_else != null">msp_warga_else = upper(#{msp_warga_else:VARCHAR}),</if>
            <if test="msp_status_nikah != null">msp_status_nikah = #{msp_status_nikah:INTEGER},</if>
            <if test="msp_agama != null">msp_agama = #{msp_agama:VARCHAR},</if>
            <if test="msp_pendidikan != null">msp_pendidikan = #{msp_pendidikan:INTEGER},</if>
            <if test="msp_pendidikan_else != null">msp_pendidikan_else = upper(#{msp_pendidikan_else:VARCHAR}),</if>
            <if test="msp_occupation != null">msp_occupation = #{msp_occupation:VARCHAR},</if>
            <if test="msp_occupation_else != null">msp_occupation_else = upper(#{msp_occupation_else:VARCHAR}),</if>
            <if test="msp_company_name != null">msp_company_name = upper(#{msp_company_name:VARCHAR}),</if>
            <if test="msp_company_usaha != null">msp_company_usaha = #{msp_company_usaha:INTEGER},</if>
            <if test="msp_company_jabatan != null">msp_company_jabatan = upper(#{msp_company_jabatan:VARCHAR}),</if>
            <if test="msp_company_address != null">msp_company_address = upper(#{msp_company_address:VARCHAR}),</if>
            <if test="msp_company_postal_code != null">msp_company_postal_code = upper(#{msp_company_postal_code:VARCHAR}),</if>
            <if test="msp_company_phone_number != null">msp_company_phone_number = #{msp_company_phone_number:VARCHAR},</if>
            msp_cek_ktp = #{msp_cek_ktp:INTEGER},
            msp_cek_kk = #{msp_cek_kk:INTEGER},
            msp_cek_npwp = #{msp_cek_npwp:INTEGER},
            msp_cek_bukti_bayar = #{msp_cek_bukti_bayar:INTEGER},
            msp_cek_srt_keterangan = #{msp_cek_srt_keterangan:INTEGER},
            msp_cek_rekening = #{msp_cek_rekening:INTEGER},
            msp_cek_ktp_uw = #{msp_cek_ktp_uw:INTEGER},
            msp_cek_kk_uw = #{msp_cek_kk_uw:INTEGER},
            msp_cek_npwp_uw = #{msp_cek_npwp_uw:INTEGER},
            msp_cek_bukti_bayar_uw = #{msp_cek_bukti_bayar_uw:INTEGER},
            msp_cek_srt_keterangan_uw = #{msp_cek_srt_keterangan_uw:INTEGER},
            msp_cek_rekening_uw = #{msp_cek_rekening_uw:INTEGER},
            msp_cek_akte_kelahiran = #{msp_cek_akte_kelahiran:INTEGER},
            msp_cek_akte_kelahiran_uw = #{msp_cek_akte_kelahiran_uw:INTEGER},
            msp_cek_tandatangan = #{msp_cek_tandatangan:INTEGER},
            msp_cek_tandatangan_uw = #{msp_cek_tandatangan_uw:INTEGER},
            <if test="lsag_id != null">lsag_id = #{lsag_id:INTEGER},</if>
            <if test="msp_exist_bp_name != null">msp_exist_bp_name = upper(#{msp_exist_bp_name:VARCHAR}),</if>
            <if test="msp_area_code_rumah != null">msp_area_code_rumah = #{msp_area_code_rumah:VARCHAR},</if>
            <if test="lside_id != null">lside_id = #{lside_id:INTEGER},</if>
            <if test="msp_up != null">msp_up = #{msp_up:VARCHAR},</if>
            <if test="msp_premi != null">msp_premi = #{msp_premi:VARCHAR},</if>
            <if test="msp_company_area_code != null">msp_company_area_code = upper(#{msp_company_area_code:VARCHAR}),</if>
            <if test="product_code != null">product_code = #{product_code:VARCHAR},</if>
            <if test="jenis_pas != null">jenis_pas = upper(#{jenis_pas:VARCHAR}),</if>
            <if test="msp_company_email != null">msp_company_email = #{msp_company_email:VARCHAR},</if>
            <if test="msp_company_fax != null">msp_company_fax = #{msp_company_fax:VARCHAR},</if>
            <if test="msp_company_ijin_usaha != null">msp_company_ijin_usaha = #{msp_company_ijin_usaha:VARCHAR},</if>
            <if test="msp_rt != null">msp_rt = #{msp_rt:VARCHAR},</if>
            <if test="msp_rw != null">msp_rw = #{msp_rw:VARCHAR},</if>
            <if test="msp_kecamatan != null">msp_kecamatan = #{msp_kecamatan:VARCHAR},</if>
            <if test="msp_propinsi != null">msp_propinsi = #{msp_propinsi:VARCHAR},</if>
            <if test="msp_pas_npwp != null">msp_pas_npwp = #{msp_pas_npwp:VARCHAR},</if>
            <if test="mcl_id_pp != null">mcl_id_pp = upper(#{mcl_id_pp:VARCHAR}),</if>
            <if test="mcl_id_tt != null">mcl_id_tt = upper(#{mcl_id_tt:VARCHAR}),</if>
            <if test="msp_still_bp != null">msp_still_bp = #{msp_still_bp:INTEGER},</if>
            <if test="msp_partner_exist_bp != null">msp_partner_exist_bp = #{msp_partner_exist_bp:INTEGER},</if>
            <if test="msp_partner_still_bp != null">msp_partner_still_bp = #{msp_partner_still_bp:INTEGER},</if>
            <if test="lju_id != null">lju_id = #{lju_id:INTEGER},</if>                        
            <if test="application_id != null">application_id = #{application_id:VARCHAR},</if>
            <if test="reff_id != null">reff_id = #{reff_id:INTEGER},</if>
            <if test="lcb_no != null">lcb_no = #{lcb_no:VARCHAR},</if>
            <if test="lcb_reff != null">lcb_reff = #{lcb_reff:VARCHAR}</if>          
        </set>                                                                     
        WHERE MSP_ID = #{msp_id:NUMERIC}   
    </update>
    
    
    <!-- common -->
    
    <update id="updateCommon" parameterType="java.lang.String">
         ${value}
    </update>
 
    <update id="updateMstCounter" parameterType="java.util.HashMap">
         update eka.mst_counter
         set MSCO_VALUE = #{MSCO_VALUE}
		 where msco_number = #{MSCO_NUMBER}
		 and lca_id = #{LCA_ID}
    </update>
    
    <update id="deleteMstUrlSecure" parameterType="java.util.HashMap">
         delete eka.mst_url_secure
         where ID_SECURE_1 = eka.decrypt(#{ID_ENCRYPT_1}) and ID_SECURE_2 = eka.decrypt(#{ID_ENCRYPT_2})
    </update>
    
     <update id="updateMstPolicyDCIF" parameterType="java.util.HashMap">
         update eka.mst_policy
         set MSPO_NASABAH_DCIF = #{DCIF}
		 where REG_SPAJ = #{REG_SPAJ}
    </update>
    
    
    
</mapper>